;
; File generated by cc65 v 2.19 - Git 357f64e4e
;
	.fopt		compiler,"cc65 v 2.19 - Git 357f64e4e"
	.setcpu		"6502"
	.smart		on
	.autoimport	on
	.case		on
	.debuginfo	off
	.importzp	c_sp, sreg, regsave, regbank
	.importzp	tmp1, tmp2, tmp3, tmp4, ptr1, ptr2, ptr3, ptr4
	.macpack	longbranch
	.import		_strchr
	.import		_memcmp
	.import		_memcpy
	.import		_memset
	.export		_f_open
	.export		_f_close
	.export		_f_read
	.export		_f_write
	.export		_f_lseek
	.export		_f_truncate
	.export		_f_sync
	.export		_f_opendir
	.export		_f_closedir
	.export		_f_readdir
	.export		_f_mkdir
	.export		_f_unlink
	.export		_f_rename
	.export		_f_stat
	.export		_f_getfree
	.export		_f_mount
	.import		_get_fattime
	.import		_disk_initialize
	.import		_disk_status
	.import		_disk_read
	.import		_disk_write
	.import		_disk_ioctl

.segment	"RODATA"

_ExCvt:
	.byte	$80
	.byte	$9A
	.byte	$45
	.byte	$41
	.byte	$8E
	.byte	$41
	.byte	$8F
	.byte	$80
	.byte	$45
	.byte	$45
	.byte	$45
	.byte	$49
	.byte	$49
	.byte	$49
	.byte	$8E
	.byte	$8F
	.byte	$90
	.byte	$92
	.byte	$92
	.byte	$4F
	.byte	$99
	.byte	$4F
	.byte	$55
	.byte	$55
	.byte	$59
	.byte	$99
	.byte	$9A
	.byte	$9B
	.byte	$9C
	.byte	$9D
	.byte	$9E
	.byte	$9F
	.byte	$41
	.byte	$49
	.byte	$4F
	.byte	$55
	.byte	$A5
	.byte	$A5
	.byte	$A6
	.byte	$A7
	.byte	$A8
	.byte	$A9
	.byte	$AA
	.byte	$AB
	.byte	$AC
	.byte	$AD
	.byte	$AE
	.byte	$AF
	.byte	$B0
	.byte	$B1
	.byte	$B2
	.byte	$B3
	.byte	$B4
	.byte	$B5
	.byte	$B6
	.byte	$B7
	.byte	$B8
	.byte	$B9
	.byte	$BA
	.byte	$BB
	.byte	$BC
	.byte	$BD
	.byte	$BE
	.byte	$BF
	.byte	$C0
	.byte	$C1
	.byte	$C2
	.byte	$C3
	.byte	$C4
	.byte	$C5
	.byte	$C6
	.byte	$C7
	.byte	$C8
	.byte	$C9
	.byte	$CA
	.byte	$CB
	.byte	$CC
	.byte	$CD
	.byte	$CE
	.byte	$CF
	.byte	$D0
	.byte	$D1
	.byte	$D2
	.byte	$D3
	.byte	$D4
	.byte	$D5
	.byte	$D6
	.byte	$D7
	.byte	$D8
	.byte	$D9
	.byte	$DA
	.byte	$DB
	.byte	$DC
	.byte	$DD
	.byte	$DE
	.byte	$DF
	.byte	$E0
	.byte	$E1
	.byte	$E2
	.byte	$E3
	.byte	$E4
	.byte	$E5
	.byte	$E6
	.byte	$E7
	.byte	$E8
	.byte	$E9
	.byte	$EA
	.byte	$EB
	.byte	$EC
	.byte	$ED
	.byte	$EE
	.byte	$EF
	.byte	$F0
	.byte	$F1
	.byte	$F2
	.byte	$F3
	.byte	$F4
	.byte	$F5
	.byte	$F6
	.byte	$F7
	.byte	$F8
	.byte	$F9
	.byte	$FA
	.byte	$FB
	.byte	$FC
	.byte	$FD
	.byte	$FE
	.byte	$FF
S0001:
	.byte	$2A,$2B,$2C,$3A,$3B,$3C,$3D,$3E,$5B,$5D,$7C,$22,$3F,$7F,$00
S0002:
	.byte	$46,$41,$54,$33,$32,$20,$20,$20,$00

.segment	"BSS"

_FatFs:
	.res	2,$00
_Fsid:
	.res	2,$00

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_open (struct $anon-struct-0003 *fp, const char *path, unsigned char mode)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_open: near

.segment	"CODE"

	jsr     pusha
	ldy     #$2B
	jsr     subysp
	ldy     #$2F
	lda     (c_sp),y
	dey
	ora     (c_sp),y
	bne     L0002
	tax
	lda     #$09
	jmp     L0001
L0002:	ldy     #$2B
	lda     (c_sp),y
	and     #$3F
	sta     (c_sp),y
	lda     #$2C
	jsr     leaa0sp
	jsr     pushax
	lda     #$02
	jsr     leaa0sp
	jsr     pushax
	ldy     #$2F
	lda     (c_sp),y
	jsr     _mount_volume
	ldy     #$2A
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L0043
	ldy     #$2F
	jsr     ldptr1ysp
	jsr     ldax0sp
	ldy     #$00
	sta     (ptr1),y
	iny
	txa
	sta     (ptr1),y
	jsr     ldax0sp
	ldy     #$02
	jsr     staxysp
	lda     #$02
	jsr     leaa0sp
	jsr     pushax
	ldy     #$2F
	jsr     ldaxysp
	jsr     _follow_path
	ldy     #$2A
	sta     (c_sp),y
	lda     (c_sp),y
	bne     L0005
	dey
	lda     (c_sp),y
	and     #$80
	beq     L0005
	lda     #$06
	iny
	sta     (c_sp),y
L0005:	ldy     #$2B
	lda     (c_sp),y
	and     #$1C
	jeq     L0006
	dey
	lda     (c_sp),y
	beq     L0007
	cmp     #$04
	bne     L0008
	lda     #$02
	jsr     leaa0sp
	jsr     _dir_register
	ldy     #$2A
	sta     (c_sp),y
L0008:	iny
	lda     (c_sp),y
	ora     #$08
	jmp     L0033
L0007:	iny
	lda     (c_sp),y
	and     #$04
	beq     L000A
	lda     #$08
	jmp     L0046
L000A:	ldy     #$06
	lda     (c_sp),y
	and     #$11
	beq     L000C
	lda     #$07
L0046:	ldy     #$2A
L0033:	sta     (c_sp),y
L000C:	ldy     #$2A
	lda     (c_sp),y
	jne     L0048
	iny
	lda     (c_sp),y
	and     #$08
	jeq     L0017
	jsr     _get_fattime
	jsr     pusheax
	jsr     decsp4
	ldy     #$25
	jsr     ldaxysp
	ldy     #$0E
	jsr     incaxy
	jsr     pushax
	ldy     #$09
	jsr     ldeaxysp
	jsr     _st_32
	ldy     #$25
	jsr     ldaxysp
	ldy     #$16
	jsr     incaxy
	jsr     pushax
	ldy     #$09
	jsr     ldeaxysp
	jsr     _st_32
	ldy     #$0B
	jsr     pushwysp
	ldy     #$27
	jsr     ldaxysp
	jsr     _ld_clust
	jsr     steax0sp
	ldy     #$25
	jsr     ldaxysp
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$20
	ldy     #$00
	sta     (ptr1),y
	ldy     #$0B
	jsr     pushwysp
	ldy     #$29
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _st_clust
	ldy     #$25
	jsr     ldaxysp
	ldy     #$1C
	jsr     incaxy
	jsr     pushax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _st_32
	ldy     #$09
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$04
	sta     (ptr1),y
	jsr     ldeax0sp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     tosneeax
	beq     L0011
	ldy     #$09
	jsr     ldaxysp
	ldy     #$1F
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$0E
	jsr     leaa0sp
	jsr     pushax
	ldy     #$09
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _remove_chain
	ldy     #$36
	sta     (c_sp),y
	lda     (c_sp),y
	bne     L0012
	ldy     #$0F
	jsr     pushwysp
	ldy     #$05
	jsr     ldeaxysp
	jsr     _move_window
	ldy     #$36
	sta     (c_sp),y
	ldy     #$0F
	jsr     pushwysp
	ldy     #$09
	jsr     ldeaxysp
	ldy     #$01
	jsr     deceaxy
	ldy     #$0C
	jsr     steaxspidx
L0012:	jsr     incsp4
L0011:	jsr     incsp8
	jmp     L0017
L0006:	dey
	tax
	lda     (c_sp),y
	bne     L003B
	ldy     #$06
	lda     (c_sp),y
	and     #$10
	beq     L0015
	lda     #$04
	jmp     L0047
L0015:	ldy     #$2B
	lda     (c_sp),y
	and     #$02
	beq     L0017
	ldy     #$06
	lda     (c_sp),y
	and     #$01
	beq     L0017
	lda     #$07
L0047:	ldy     #$2A
	sta     (c_sp),y
L0017:	ldy     #$2A
L0048:	ldx     #$00
L003B:	lda     (c_sp),y
	bne     L003D
	iny
	lda     (c_sp),y
	and     #$08
	beq     L001C
	lda     (c_sp),y
	ora     #$40
	sta     (c_sp),y
L001C:	ldy     #$31
	jsr     pushwysp
	ldy     #$03
	jsr     ldaxysp
	ldy     #$1F
	jsr     ldeaxidx
	ldy     #$1C
	jsr     steaxspidx
	ldy     #$2F
	jsr     ldptr1ysp
	ldy     #$1D
	jsr     ldaxysp
	ldy     #$20
	sta     (ptr1),y
	iny
	txa
	sta     (ptr1),y
	ldy     #$2A
	ldx     #$00
L003D:	lda     (c_sp),y
	jne     L0043
	ldy     #$31
	jsr     pushwysp
	ldy     #$05
	jsr     pushwysp
	ldy     #$21
	jsr     ldaxysp
	jsr     _ld_clust
	ldy     #$06
	jsr     steaxspidx
	ldy     #$31
	jsr     pushwysp
	ldy     #$1F
	jsr     ldaxysp
	ldy     #$1C
	jsr     incaxy
	jsr     _ld_32
	ldy     #$0A
	jsr     steaxspidx
	ldy     #$2F
	jsr     ldaxysp
	sta     sreg
	stx     sreg+1
	jsr     ldax0sp
	ldy     #$07
	jsr     ldaxidx
	ldy     #$02
	sta     (sreg),y
	iny
	txa
	sta     (sreg),y
	ldy     #$2F
	jsr     ldptr1ysp
	ldy     #$2B
	lda     (c_sp),y
	ldy     #$0E
	sta     (ptr1),y
	ldy     #$2F
	jsr     ldptr1ysp
	lda     #$00
	ldy     #$0F
	sta     (ptr1),y
	ldy     #$31
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	ldy     #$18
	jsr     steaxspidx
	ldy     #$31
	jsr     pushwysp
	lda     #$00
	tax
	ldy     #$10
	jsr     steaxspidx
	ldy     #$2B
	lda     (c_sp),y
	and     #$20
	jeq     L001E
	ldy     #$2F
	jsr     ldaxysp
	ldy     #$0D
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     tosneeax
	jeq     L001E
	ldy     #$0C
	jsr     subysp
	ldy     #$3D
	jsr     pushwysp
	ldy     #$3D
	jsr     ldaxysp
	ldy     #$0D
	jsr     ldeaxidx
	ldy     #$10
	jsr     steaxspidx
	ldy     #$0D
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	jsr     axulong
	ldy     sreg
	sty     sreg+1
	stx     sreg
	tax
	lda     #$00
	jsr     shleax1
	ldy     #$08
	jsr     steaxysp
	ldy     #$3B
	jsr     ldaxysp
	ldy     #$09
	jsr     ldeaxidx
	ldy     #$04
	jsr     steaxysp
	ldy     #$3B
	jsr     ldaxysp
	ldy     #$0D
	jsr     ldeaxidx
	jsr     steax0sp
L0022:	ldy     #$36
	lda     (c_sp),y
	bne     L0023
	jsr     ldeax0sp
	jsr     pusheax
	ldy     #$0F
	jsr     ldeaxysp
	jsr     tosugteax
	beq     L0023
	ldy     #$3D
	jsr     pushwysp
	ldy     #$09
	jsr     ldeaxysp
	jsr     _get_fat
	ldy     #$04
	jsr     steaxysp
	ldy     #$07
	jsr     ldeaxysp
	cmp     #$02
	txa
	sbc     #$00
	lda     sreg
	sbc     #$00
	lda     sreg+1
	sbc     #$00
	bcs     L0029
	lda     #$02
	ldy     #$36
	sta     (c_sp),y
L0029:	ldy     #$07
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0024
	lda     #$01
	ldy     #$36
	sta     (c_sp),y
L0024:	ldy     #$0B
	jsr     ldeaxysp
	jsr     lsubeq0sp
	jmp     L0022
L0023:	ldy     #$3D
	jsr     pushwysp
	ldy     #$09
	jsr     ldeaxysp
	ldy     #$14
	jsr     steaxspidx
	ldy     #$36
	lda     (c_sp),y
	bne     L002B
	jsr     ldeax0sp
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     utsteax
	beq     L002B
	ldy     #$0F
	jsr     pushwysp
	ldy     #$09
	jsr     ldeaxysp
	jsr     _clst2sect
	jsr     pusheax
	jsr     ldeax0sp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L002F
	lda     #$02
	ldy     #$3A
	sta     (c_sp),y
	jmp     L0030
L002F:	ldy     #$41
	jsr     pushwysp
	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$0D
	jsr     ldeaxysp
	txa
	ldx     sreg
	ldy     sreg+1
	sty     sreg
	ldy     #$00
	sty     sreg+1
	jsr     shreax1
	jsr     tosaddeax
	ldy     #$18
	jsr     steaxspidx
L0030:	jsr     incsp4
L002B:	ldy     #$0C
	jsr     addysp
L001E:	ldy     #$2A
	ldx     #$00
L0043:	lda     (c_sp),y
	beq     L0045
	ldy     #$2F
	jsr     ldptr1ysp
	lda     #$00
	tay
	sta     (ptr1),y
	iny
	sta     (ptr1),y
	ldy     #$2A
	tax
L0045:	lda     (c_sp),y
L0001:	ldy     #$30
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_close (struct $anon-struct-0003 *fp)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_close: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp3
	ldy     #$04
	jsr     ldaxysp
	jsr     _f_sync
	ldy     #$02
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0005
	ldy     #$06
	jsr     pushwysp
	lda     #$02
	jsr     leaa0sp
	jsr     _validate
	ldy     #$02
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0005
	ldy     #$04
	jsr     ldptr1ysp
	lda     #$00
	tay
	sta     (ptr1),y
	iny
	sta     (ptr1),y
	iny
	tax
L0005:	lda     (c_sp),y
	jmp     incsp5

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_read (struct $anon-struct-0003 *fp, void *buff, unsigned int btr, unsigned int *br)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_read: near

.segment	"CODE"

	jsr     pushax
	ldy     #$11
	jsr     subysp
	ldy     #$18
	jsr     pushwysp
	ldy     #$14
	jsr     ldptr1ysp
	lda     #$00
	tay
	sta     (ptr1),y
	iny
	sta     (ptr1),y
	ldy     #$1C
	jsr     pushwysp
	lda     #$12
	jsr     leaa0sp
	jsr     _validate
	ldy     #$12
	sta     (c_sp),y
	lda     (c_sp),y
	bne     L001F
	ldy     #$1A
	jsr     ldptr1ysp
	ldy     #$0F
	lda     (ptr1),y
	ldy     #$12
	sta     (c_sp),y
	cmp     #$00
	beq     L0002
L001F:	ldx     #$00
	lda     (c_sp),y
	jmp     L0001
L0002:	ldy     #$1A
	jsr     ldptr1ysp
	ldy     #$0E
	lda     (ptr1),y
	and     #$01
	bne     L0005
	tax
	lda     #$07
	jmp     L0001
L0005:	ldy     #$1A
	jsr     ldaxysp
	ldy     #$0D
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     tossubeax
	ldy     #$08
	jsr     steaxysp
	ldy     #$18
	jsr     pushwysp
	ldy     #$0D
	jsr     ldeaxysp
	jsr     tosulong
	jsr     tosugteax
	beq     L0006
	ldy     #$09
	jsr     ldaxysp
	ldy     #$15
	jsr     staxysp
L0006:	ldy     #$15
	lda     (c_sp),y
	iny
	ora     (c_sp),y
	jeq     L0008
	ldy     #$1A
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	jeq     L000C
	ldy     #$1A
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	txa
	ldx     sreg
	ldy     sreg+1
	sty     sreg
	ldy     #$00
	sty     sreg+1
	jsr     shreax1
	jsr     pusheax
	ldy     #$15
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	jsr     decax1
	jsr     axulong
	jsr     tosandeax
	ldy     #$02
	jsr     staxysp
	cpx     #$00
	jne     L000D
	cmp     #$00
	jne     L000D
	jsr     decsp4
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L000F
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$09
	jsr     ldeaxidx
	jmp     L0022
L000F:	ldy     #$20
	jsr     pushwysp
	ldy     #$20
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     _get_fat
L0022:	jsr     steax0sp
	jsr     ldeax0sp
	cmp     #$02
	txa
	sbc     #$00
	lda     sreg
	sbc     #$00
	lda     sreg+1
	sbc     #$00
	bcs     L0011
	ldy     #$1E
	jsr     ldptr1ysp
	lda     #$02
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jsr     incsp4
	jmp     L0001
L0011:	jsr     ldeax0sp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0012
	ldy     #$1E
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jsr     incsp4
	jmp     L0001
L0012:	ldy     #$20
	jsr     pushwysp
	ldy     #$05
	jsr     ldeaxysp
	ldy     #$14
	jsr     steaxspidx
	jsr     incsp4
L000D:	ldy     #$13
	jsr     pushwysp
	ldy     #$1C
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     _clst2sect
	ldy     #$0C
	jsr     steaxysp
	ldy     #$0F
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0013
	ldy     #$1A
	jsr     ldptr1ysp
	lda     #$02
	ldy     #$0F
	sta     (ptr1),y
	jmp     L0008
L0013:	ldy     #$03
	jsr     ldaxysp
	jsr     axulong
	ldy     #$0C
	jsr     laddeqysp
	ldy     #$16
	jsr     ldaxysp
	txa
	ldx     #$00
	lsr     a
	ldy     #$04
	jsr     staxysp
	cmp     #$00
	jeq     L0014
	ldy     #$05
	jsr     ldaxysp
	clc
	ldy     #$02
	adc     (c_sp),y
	pha
	txa
	iny
	adc     (c_sp),y
	tax
	pla
	jsr     pushax
	ldy     #$13
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	jsr     tosicmp
	bcc     L0016
	beq     L0016
	ldy     #$11
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	sec
	ldy     #$02
	sbc     (c_sp),y
	pha
	txa
	iny
	sbc     (c_sp),y
	tax
	pla
	iny
	jsr     staxysp
L0016:	ldy     #$11
	jsr     ldptr1ysp
	ldy     #$01
	lda     (ptr1),y
	jsr     pusha
	ldy     #$04
	jsr     pushwysp
	ldy     #$12
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$0C
	jsr     ldaxysp
	jsr     _disk_read
	cmp     #$00
	beq     L0017
	ldy     #$1A
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$0F
	sta     (ptr1),y
	jmp     L0008
L0017:	ldy     #$11
	jsr     ldptr1ysp
	ldy     #$04
	lda     (ptr1),y
	beq     L0023
	ldy     #$11
	jsr     ldaxysp
	ldy     #$1F
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$13
	jsr     ldeaxysp
	jsr     tossubeax
	jsr     pusheax
	ldy     #$09
	jsr     ldaxysp
	jsr     axulong
	jsr     tosulteax
	beq     L0018
	jsr     pushw0sp
	ldy     #$13
	jsr     ldaxysp
	ldy     #$1F
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$15
	jsr     ldeaxysp
	jsr     tossubeax
	ldy     sreg
	sty     sreg+1
	stx     sreg
	tax
	lda     #$00
	jsr     shleax1
	jsr     tosaddax
	jsr     pushax
	ldy     #$13
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldx     #$02
	lda     #$00
	jsr     _memcpy
L0018:	ldy     #$04
L0023:	lda     (c_sp),y
	tax
	lda     #$00
	jsr     shlax1
	ldy     #$06
	jsr     staxysp
	jmp     L0009
L0014:	ldy     #$1C
	jsr     pushwysp
	ldy     #$11
	jsr     ldeaxysp
	ldy     #$18
	jsr     steaxspidx
L000C:	ldx     #$02
	lda     #$00
	jsr     pushax
	ldy     #$1C
	jsr     ldaxysp
	ldy     #$11
	jsr     ldaxidx
	tay
	txa
	and     #$01
	tax
	tya
	jsr     tossubax
	ldy     #$06
	jsr     staxysp
	sec
	ldy     #$15
	sbc     (c_sp),y
	sta     tmp1
	txa
	iny
	sbc     (c_sp),y
	ora     tmp1
	bcc     L001C
	beq     L001C
	jsr     ldaxysp
	ldy     #$06
	jsr     staxysp
L001C:	ldy     #$13
	jsr     pushwysp
	ldy     #$1C
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldeaxidx
	jsr     _move_window
	cmp     #$00
	beq     L001D
	ldy     #$1A
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$0F
	sta     (ptr1),y
	jmp     L0008
L001D:	jsr     pushw0sp
	ldy     #$13
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     tosaddax
	jsr     pushax
	ldy     #$0B
	jsr     ldaxysp
	jsr     _memcpy
L0009:	ldy     #$07
	jsr     ldaxysp
	ldy     #$15
	jsr     subeqysp
	ldy     #$14
	jsr     ldaxysp
	sta     sreg
	stx     sreg+1
	jsr     ldaxi
	sta     ptr1
	stx     ptr1+1
	ldy     #$07
	jsr     ldaxysp
	clc
	adc     ptr1
	pha
	txa
	adc     ptr1+1
	tax
	pla
	ldy     #$00
	sta     (sreg),y
	iny
	txa
	sta     (sreg),y
	ldy     #$07
	jsr     ldaxysp
	jsr     addeq0sp
	ldy     #$1A
	jsr     ldaxysp
	jsr     pushax
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$0D
	jsr     ldaxysp
	jsr     axulong
	jsr     tosaddeax
	ldy     #$10
	jsr     steaxspidx
	jmp     L0006
L0008:	ldx     #$00
L0001:	ldy     #$1B
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_write (struct $anon-struct-0003 *fp, const void *buff, unsigned int btw, unsigned int *bw)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_write: near

.segment	"CODE"

	jsr     pushax
	ldy     #$11
	jsr     subysp
	ldy     #$18
	jsr     pushwysp
	ldy     #$14
	jsr     ldptr1ysp
	lda     #$00
	tay
	sta     (ptr1),y
	iny
	sta     (ptr1),y
	ldy     #$1C
	jsr     pushwysp
	lda     #$12
	jsr     leaa0sp
	jsr     _validate
	ldy     #$12
	sta     (c_sp),y
	lda     (c_sp),y
	bne     L002A
	ldy     #$1A
	jsr     ldptr1ysp
	ldy     #$0F
	lda     (ptr1),y
	ldy     #$12
	sta     (c_sp),y
	cmp     #$00
	beq     L0002
L002A:	ldx     #$00
	lda     (c_sp),y
	jmp     L0001
L0002:	ldy     #$1A
	jsr     ldptr1ysp
	ldy     #$0E
	lda     (ptr1),y
	and     #$02
	bne     L0005
	tax
	lda     #$07
	jmp     L0001
L0005:	ldy     #$1A
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$1A
	jsr     ldaxysp
	jsr     axulong
	jsr     tosaddeax
	jsr     pusheax
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     tosulteax
	beq     L0006
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     pusheax
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     tossubeax
	ldy     #$15
	jsr     staxysp
L0006:	ldy     #$15
	lda     (c_sp),y
	iny
	ora     (c_sp),y
	jeq     L000A
	ldy     #$1A
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	jeq     L0010
	ldy     #$1A
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	txa
	ldx     sreg
	ldy     sreg+1
	sty     sreg
	ldy     #$00
	sty     sreg+1
	jsr     shreax1
	sta     sreg
	stx     sreg+1
	ldy     #$11
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	jsr     decax1
	and     sreg
	pha
	txa
	and     sreg+1
	tax
	pla
	ldy     #$02
	jsr     staxysp
	cpx     #$00
	jne     L0019
	cmp     #$00
	jne     L0019
	ldy     #$1A
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0013
	ldy     #$1A
	jsr     ldaxysp
	ldy     #$09
	jsr     ldeaxidx
	ldy     #$0C
	jsr     steaxysp
	ldy     #$0F
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0015
	ldy     #$1C
	jsr     pushwysp
	lda     #$00
	tax
	jmp     L002C
L0013:	ldy     #$1C
	jsr     pushwysp
	ldy     #$1C
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
L002C:	jsr     _create_chain
	ldy     #$0C
	jsr     steaxysp
L0015:	ldy     #$0F
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	jne     L000A
	ldy     #$0F
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	jsr     toseqeax
	beq     L0017
	ldy     #$1A
	jsr     ldptr1ysp
	lda     #$02
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jmp     L0001
L0017:	ldy     #$0F
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0018
	ldy     #$1A
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jmp     L0001
L0018:	ldy     #$1C
	jsr     pushwysp
	ldy     #$11
	jsr     ldeaxysp
	ldy     #$14
	jsr     steaxspidx
	ldy     #$1A
	jsr     ldaxysp
	ldy     #$09
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0019
	ldy     #$1C
	jsr     pushwysp
	ldy     #$11
	jsr     ldeaxysp
	ldy     #$06
	jsr     steaxspidx
L0019:	ldy     #$11
	jsr     ldaxysp
	ldy     #$1F
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldeaxidx
	jsr     toseqeax
	beq     L001A
	ldy     #$11
	jsr     ldaxysp
	jsr     _sync_window
	cmp     #$00
	beq     L001A
	ldy     #$1A
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jmp     L0001
L001A:	ldy     #$13
	jsr     pushwysp
	ldy     #$1C
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     _clst2sect
	ldy     #$08
	jsr     steaxysp
	ldy     #$0B
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L001E
	ldy     #$1A
	jsr     ldptr1ysp
	lda     #$02
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jmp     L0001
L001E:	ldy     #$03
	jsr     ldaxysp
	jsr     axulong
	ldy     #$08
	jsr     laddeqysp
	ldy     #$16
	jsr     ldaxysp
	txa
	ldx     #$00
	lsr     a
	ldy     #$04
	jsr     staxysp
	cmp     #$00
	jeq     L001F
	ldy     #$05
	jsr     ldaxysp
	clc
	ldy     #$02
	adc     (c_sp),y
	pha
	txa
	iny
	adc     (c_sp),y
	tax
	pla
	jsr     pushax
	ldy     #$13
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	jsr     tosicmp
	bcc     L0021
	beq     L0021
	ldy     #$11
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	sec
	ldy     #$02
	sbc     (c_sp),y
	pha
	txa
	iny
	sbc     (c_sp),y
	tax
	pla
	iny
	jsr     staxysp
L0021:	ldy     #$11
	jsr     ldptr1ysp
	ldy     #$01
	lda     (ptr1),y
	jsr     pusha
	ldy     #$04
	jsr     pushwysp
	ldy     #$0E
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$0C
	jsr     ldaxysp
	jsr     _disk_write
	cmp     #$00
	beq     L0022
	ldy     #$1A
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jmp     L0001
L0022:	ldy     #$11
	jsr     ldaxysp
	ldy     #$1F
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$0F
	jsr     ldeaxysp
	jsr     tossubeax
	jsr     pusheax
	ldy     #$09
	jsr     ldaxysp
	jsr     axulong
	jsr     tosulteax
	beq     L0023
	ldy     #$11
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$05
	jsr     pushwysp
	ldy     #$15
	jsr     ldaxysp
	ldy     #$1F
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$13
	jsr     ldeaxysp
	jsr     tossubeax
	ldy     sreg
	sty     sreg+1
	stx     sreg
	tax
	lda     #$00
	jsr     shleax1
	jsr     tosaddax
	jsr     pushax
	ldx     #$02
	lda     #$00
	jsr     _memcpy
	ldy     #$11
	jsr     ldptr1ysp
	lda     #$00
	ldy     #$04
	sta     (ptr1),y
L0023:	ldy     #$04
	lda     (c_sp),y
	tax
	lda     #$00
	jsr     shlax1
	ldy     #$06
	jsr     staxysp
	jmp     L000B
L001F:	ldy     #$1A
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$0D
	jsr     ldeaxidx
	jsr     tosugeeax
	beq     L0024
	ldy     #$11
	jsr     ldaxysp
	jsr     _sync_window
	cmp     #$00
	beq     L0025
	ldy     #$1A
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jmp     L0001
L0025:	ldy     #$13
	jsr     pushwysp
	ldy     #$0D
	jsr     ldeaxysp
	ldy     #$1C
	jsr     steaxspidx
L0024:	ldy     #$1C
	jsr     pushwysp
	ldy     #$0D
	jsr     ldeaxysp
	ldy     #$18
	jsr     steaxspidx
L0010:	ldx     #$02
	lda     #$00
	jsr     pushax
	ldy     #$1C
	jsr     ldaxysp
	ldy     #$11
	jsr     ldaxidx
	tay
	txa
	and     #$01
	tax
	tya
	jsr     tossubax
	ldy     #$06
	jsr     staxysp
	sec
	ldy     #$15
	sbc     (c_sp),y
	sta     tmp1
	txa
	iny
	sbc     (c_sp),y
	ora     tmp1
	bcc     L0026
	beq     L0026
	jsr     ldaxysp
	ldy     #$06
	jsr     staxysp
L0026:	ldy     #$13
	jsr     pushwysp
	ldy     #$1C
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldeaxidx
	jsr     _move_window
	cmp     #$00
	beq     L0027
	ldy     #$1A
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jmp     L0001
L0027:	ldy     #$11
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$1C
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     tosaddax
	jsr     pushax
	ldy     #$05
	jsr     pushwysp
	ldy     #$0B
	jsr     ldaxysp
	jsr     _memcpy
	ldy     #$11
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$04
	sta     (ptr1),y
L000B:	ldy     #$07
	jsr     ldaxysp
	ldy     #$15
	jsr     subeqysp
	ldy     #$14
	jsr     ldaxysp
	sta     sreg
	stx     sreg+1
	jsr     ldaxi
	sta     ptr1
	stx     ptr1+1
	ldy     #$07
	jsr     ldaxysp
	clc
	adc     ptr1
	pha
	txa
	adc     ptr1+1
	tax
	pla
	ldy     #$00
	sta     (sreg),y
	iny
	txa
	sta     (sreg),y
	ldy     #$07
	jsr     ldaxysp
	jsr     addeq0sp
	ldy     #$1A
	jsr     ldaxysp
	jsr     pushax
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$0D
	jsr     ldaxysp
	jsr     axulong
	jsr     tosaddeax
	ldy     #$10
	jsr     steaxspidx
	ldy     #$1C
	jsr     pushwysp
	ldy     #$1C
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$20
	jsr     ldaxysp
	ldy     #$0D
	jsr     ldeaxidx
	jsr     tosugteax
	beq     L000E
	ldy     #$1C
	jsr     ldaxysp
	ldy     #$13
	jmp     L0029
L000E:	ldy     #$1C
	jsr     ldaxysp
	ldy     #$0D
L0029:	jsr     ldeaxidx
	ldy     #$0A
	jsr     steaxspidx
	jmp     L0006
L000A:	ldy     #$1A
	jsr     ldptr1ysp
	ldy     #$0E
	lda     (ptr1),y
	ora     #$40
	sta     (ptr1),y
	ldx     #$00
	txa
L0001:	ldy     #$1B
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_lseek (struct $anon-struct-0003 *fp, unsigned long ofs)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_lseek: near

.segment	"CODE"

	jsr     pusheax
	ldy     #$13
	jsr     subysp
	ldy     #$1A
	jsr     pushwysp
	lda     #$12
	jsr     leaa0sp
	jsr     _validate
	ldy     #$12
	sta     (c_sp),y
	lda     (c_sp),y
	bne     L002A
	ldy     #$18
	jsr     ldptr1ysp
	ldy     #$0F
	lda     (ptr1),y
	ldy     #$12
	sta     (c_sp),y
L002A:	lda     (c_sp),y
	jne     L0030
	ldy     #$16
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$1C
	jsr     ldaxysp
	ldy     #$0D
	jsr     ldeaxidx
	jsr     tosugteax
	beq     L0004
	ldy     #$18
	jsr     ldptr1ysp
	ldy     #$0E
	lda     (ptr1),y
	and     #$02
	bne     L0004
	ldy     #$18
	jsr     ldaxysp
	ldy     #$0D
	jsr     ldeaxidx
	ldy     #$13
	jsr     steaxysp
L0004:	ldy     #$18
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     steax0sp
	ldy     #$1A
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	ldy     #$06
	jsr     steaxysp
	ldy     #$10
	jsr     steaxspidx
	ldy     #$16
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     tosneeax
	jeq     L001F
	ldy     #$11
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	jsr     axulong
	ldy     sreg
	sty     sreg+1
	stx     sreg
	tax
	lda     #$00
	jsr     shleax1
	ldy     #$08
	jsr     steaxysp
	jsr     ldeax0sp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     tosneeax
	beq     L000B
	ldy     #$16
	jsr     ldeaxysp
	ldy     #$01
	jsr     deceaxy
	jsr     pusheax
	ldy     #$0F
	jsr     ldeaxysp
	jsr     tosudiveax
	jsr     pusheax
	ldy     #$07
	jsr     ldeaxysp
	ldy     #$01
	jsr     deceaxy
	jsr     pusheax
	ldy     #$13
	jsr     ldeaxysp
	jsr     tosudiveax
	jsr     tosugeeax
	beq     L000B
	ldy     #$1A
	jsr     pushwysp
	ldy     #$05
	jsr     ldeaxysp
	ldy     #$01
	jsr     deceaxy
	jsr     pusheax
	ldy     #$11
	jsr     ldeaxysp
	ldy     #$01
	jsr     deceaxy
	jsr     compleax
	jsr     tosandeax
	ldy     #$10
	jsr     steaxspidx
	ldy     #$18
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	ldy     #$13
	jsr     lsubeqysp
	ldy     #$18
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	ldy     #$0C
	jsr     steaxysp
	jmp     L000F
L000B:	ldy     #$18
	jsr     ldaxysp
	ldy     #$09
	jsr     ldeaxidx
	ldy     #$0C
	jsr     steaxysp
	ldy     #$0F
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0010
	ldy     #$1A
	jsr     pushwysp
	lda     #$00
	tax
	jsr     _create_chain
	ldy     #$0C
	jsr     steaxysp
	ldy     #$0F
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	jsr     toseqeax
	beq     L0011
	ldy     #$18
	jsr     ldptr1ysp
	lda     #$02
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jmp     L0001
L0011:	ldy     #$0F
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0012
	ldy     #$18
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jmp     L0001
L0012:	ldy     #$1A
	jsr     pushwysp
	ldy     #$11
	jsr     ldeaxysp
	ldy     #$06
	jsr     steaxspidx
L0010:	ldy     #$1A
	jsr     pushwysp
	ldy     #$11
	jsr     ldeaxysp
	ldy     #$14
	jsr     steaxspidx
L000F:	ldy     #$0F
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     tosneeax
	jeq     L001F
	jmp     L0016
L0014:	ldy     #$0B
	jsr     ldeaxysp
	ldy     #$13
	jsr     lsubeqysp
	ldy     #$18
	jsr     ldaxysp
	jsr     pushax
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$11
	jsr     ldeaxysp
	jsr     tosaddeax
	ldy     #$10
	jsr     steaxspidx
	ldy     #$18
	jsr     ldptr1ysp
	ldy     #$0E
	lda     (ptr1),y
	and     #$02
	beq     L0017
	ldy     #$1A
	jsr     pushwysp
	ldy     #$11
	jsr     ldeaxysp
	jsr     _create_chain
	ldy     #$0C
	jsr     steaxysp
	ldy     #$0F
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L001A
	lda     #$00
	tax
	ldy     #$13
	jsr     steaxysp
	jmp     L0015
L0017:	ldy     #$1A
	jsr     pushwysp
	ldy     #$11
	jsr     ldeaxysp
	jsr     _get_fat
	ldy     #$0C
	jsr     steaxysp
L001A:	ldy     #$0F
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L001B
	ldy     #$18
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jmp     L0001
L001B:	ldy     #$0F
	jsr     ldeaxysp
	cmp     #$02
	txa
	sbc     #$00
	lda     sreg
	sbc     #$00
	lda     sreg+1
	sbc     #$00
	bcc     L001D
	ldy     #$0F
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$15
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosugeeax
	beq     L001C
L001D:	ldy     #$18
	jsr     ldptr1ysp
	lda     #$02
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jmp     L0001
L001C:	ldy     #$1A
	jsr     pushwysp
	ldy     #$11
	jsr     ldeaxysp
	ldy     #$14
	jsr     steaxspidx
L0016:	ldy     #$16
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$0F
	jsr     ldeaxysp
	jsr     tosugteax
	jne     L0014
L0015:	ldy     #$18
	jsr     ldaxysp
	jsr     pushax
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$1C
	jsr     ldeaxysp
	jsr     tosaddeax
	ldy     #$10
	jsr     steaxspidx
	ldy     #$16
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     utsteax
	beq     L001F
	ldy     #$13
	jsr     pushwysp
	ldy     #$11
	jsr     ldeaxysp
	jsr     _clst2sect
	ldy     #$04
	jsr     steaxysp
	ldy     #$07
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0020
	ldy     #$18
	jsr     ldptr1ysp
	lda     #$02
	ldy     #$0F
	sta     (ptr1),y
	ldx     #$00
	jmp     L0001
L0020:	ldy     #$16
	jsr     ldeaxysp
	txa
	ldx     sreg
	ldy     sreg+1
	sty     sreg
	ldy     #$00
	sty     sreg+1
	jsr     shreax1
	ldy     #$04
	jsr     laddeqysp
L001F:	ldy     #$18
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$1C
	jsr     ldaxysp
	ldy     #$0D
	jsr     ldeaxidx
	jsr     tosugteax
	beq     L0021
	ldy     #$1A
	jsr     pushwysp
	ldy     #$1A
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	ldy     #$0A
	jsr     steaxspidx
	ldy     #$18
	jsr     ldptr1ysp
	ldy     #$0E
	lda     (ptr1),y
	ora     #$40
	sta     (ptr1),y
L0021:	ldy     #$18
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     utsteax
	beq     L0024
	ldy     #$07
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$1C
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldeaxidx
	jsr     tosneeax
	beq     L0024
	ldy     #$1A
	jsr     pushwysp
	ldy     #$09
	jsr     ldeaxysp
	ldy     #$18
	jsr     steaxspidx
L0024:	ldy     #$12
L0030:	ldx     #$00
	lda     (c_sp),y
L0001:	ldy     #$19
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_truncate (struct $anon-struct-0003 *fp)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_truncate: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp7
	ldy     #$0A
	jsr     pushwysp
	lda     #$06
	jsr     leaa0sp
	jsr     _validate
	ldy     #$06
	sta     (c_sp),y
	lda     (c_sp),y
	jne     L0014
	ldy     #$08
	jsr     ldptr1ysp
	ldy     #$0F
	lda     (ptr1),y
	ldy     #$06
	sta     (c_sp),y
	cmp     #$00
	jne     L0014
	ldy     #$08
	jsr     ldptr1ysp
	ldy     #$0E
	lda     (ptr1),y
	and     #$02
	bne     L0005
	tax
	lda     #$07
	jmp     L0001
L0005:	ldy     #$08
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$0C
	jsr     ldaxysp
	ldy     #$0D
	jsr     ldeaxidx
	jsr     tosulteax
	jeq     L000F
	ldy     #$08
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0007
	ldy     #$0A
	jsr     pushwysp
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$09
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _remove_chain
	ldy     #$06
	sta     (c_sp),y
	ldy     #$0A
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	ldy     #$06
	jsr     steaxspidx
	jmp     L000B
L0007:	ldy     #$0A
	jsr     pushwysp
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     _get_fat
	jsr     steax0sp
	lda     #$00
	ldy     #$06
	sta     (c_sp),y
	jsr     ldeax0sp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0009
	lda     #$01
	ldy     #$06
	sta     (c_sp),y
L0009:	jsr     ldeax0sp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	jsr     toseqeax
	beq     L000A
	lda     #$02
	ldy     #$06
	sta     (c_sp),y
L000A:	ldy     #$06
	lda     (c_sp),y
	bne     L000B
	jsr     ldeax0sp
	jsr     pusheax
	ldy     #$09
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosulteax
	beq     L000B
	ldy     #$0A
	jsr     pushwysp
	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$0E
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     _remove_chain
	ldy     #$06
	sta     (c_sp),y
L000B:	ldy     #$0A
	jsr     pushwysp
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	ldy     #$0A
	jsr     steaxspidx
	ldy     #$08
	jsr     ldptr1ysp
	ldy     #$0E
	lda     (ptr1),y
	ora     #$40
	sta     (ptr1),y
	ldy     #$06
	ldx     #$00
	lda     (c_sp),y
	beq     L0010
	ldy     #$08
	jsr     ldptr1ysp
	ldy     #$06
	lda     (c_sp),y
	ldy     #$0F
	sta     (ptr1),y
L000F:	ldy     #$06
L0014:	ldx     #$00
L0010:	lda     (c_sp),y
L0001:	ldy     #$09
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_sync (struct $anon-struct-0003 *fp)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_sync: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp3
	ldy     #$06
	jsr     pushwysp
	lda     #$02
	jsr     leaa0sp
	jsr     _validate
	ldy     #$02
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L0006
	ldy     #$04
	jsr     ldptr1ysp
	ldy     #$0E
	lda     (ptr1),y
	and     #$40
	jeq     L0004
	jsr     pushw0sp
	ldy     #$06
	jsr     ldaxysp
	ldy     #$1F
	jsr     ldeaxidx
	jsr     _move_window
	ldy     #$02
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L0006
	ldy     #$04
	jsr     ldaxysp
	ldy     #$21
	jsr     pushwidx
	jsr     ldax0sp
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	ora     #$20
	sta     (ptr1),y
	ldy     #$06
	jsr     ldaxysp
	jsr     pushw
	ldy     #$05
	jsr     pushwysp
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$09
	jsr     ldeaxidx
	jsr     _st_clust
	jsr     ldax0sp
	ldy     #$1C
	jsr     incaxy
	jsr     pushax
	ldy     #$08
	jsr     ldaxysp
	ldy     #$0D
	jsr     ldeaxidx
	jsr     _st_32
	jsr     ldax0sp
	ldy     #$16
	jsr     incaxy
	jsr     pushax
	jsr     _get_fattime
	jsr     _st_32
	jsr     ldax0sp
	ldy     #$12
	jsr     incaxy
	jsr     pushax
	ldx     #$00
	txa
	jsr     _st_16
	ldy     #$03
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$04
	sta     (ptr1),y
	dey
	jsr     ldaxysp
	jsr     _sync_fs
	ldy     #$04
	sta     (c_sp),y
	ldy     #$06
	jsr     ldptr1ysp
	ldy     #$0E
	lda     (ptr1),y
	and     #$BF
	sta     (ptr1),y
	jsr     incsp2
L0004:	ldy     #$02
	ldx     #$00
L0006:	lda     (c_sp),y
	jmp     incsp5

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_opendir (struct $anon-struct-0004 *dp, const char *path)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_opendir: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp3
	ldy     #$06
	lda     (c_sp),y
	dey
	ora     (c_sp),y
	bne     L0002
	tax
	lda     #$09
	jmp     incsp7
L0002:	lda     #$03
	jsr     leaa0sp
	jsr     pushax
	lda     #$02
	jsr     leaa0sp
	jsr     pushax
	lda     #$00
	jsr     _mount_volume
	ldy     #$02
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L000F
	ldy     #$06
	jsr     ldptr1ysp
	jsr     ldax0sp
	ldy     #$00
	sta     (ptr1),y
	iny
	txa
	sta     (ptr1),y
	ldy     #$08
	jsr     pushwysp
	ldy     #$06
	jsr     ldaxysp
	jsr     _follow_path
	ldy     #$02
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L000D
	ldy     #$06
	jsr     ldaxysp
	ldy     #$1C
	jsr     incaxy
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	and     #$80
	bne     L0007
	ldy     #$06
	jsr     ldptr1ysp
	ldy     #$04
	lda     (ptr1),y
	and     #$10
	beq     L000B
	ldy     #$08
	jsr     pushwysp
	ldy     #$05
	jsr     pushwysp
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	jsr     _ld_clust
	ldy     #$06
	jsr     steaxspidx
	jmp     L0007
L000B:	lda     #$05
	ldy     #$02
	sta     (c_sp),y
L0007:	ldy     #$02
	ldx     #$00
	lda     (c_sp),y
	bne     L000D
	ldy     #$06
	jsr     ldaxysp
	sta     sreg
	stx     sreg+1
	jsr     ldax0sp
	ldy     #$07
	jsr     ldaxidx
	ldy     #$02
	sta     (sreg),y
	iny
	txa
	sta     (sreg),y
	ldy     #$08
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _dir_sdi
	ldy     #$02
	sta     (c_sp),y
	ldx     #$00
L000D:	lda     (c_sp),y
	cmp     #$04
	bne     L000F
	lda     #$05
	sta     (c_sp),y
L000F:	lda     (c_sp),y
	beq     L0011
	ldy     #$06
	jsr     ldptr1ysp
	lda     #$00
	tay
	sta     (ptr1),y
	iny
	sta     (ptr1),y
	iny
	tax
L0011:	lda     (c_sp),y
	jmp     incsp7

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_closedir (struct $anon-struct-0004 *dp)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_closedir: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp3
	ldy     #$06
	jsr     pushwysp
	lda     #$02
	jsr     leaa0sp
	jsr     _validate
	ldy     #$02
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0004
	ldy     #$04
	jsr     ldptr1ysp
	lda     #$00
	tay
	sta     (ptr1),y
	iny
	sta     (ptr1),y
	iny
	tax
L0004:	lda     (c_sp),y
	jmp     incsp5

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_readdir (struct $anon-struct-0004 *dp, struct $anon-struct-0005 *fno)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_readdir: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp3
	ldy     #$08
	jsr     pushwysp
	lda     #$02
	jsr     leaa0sp
	jsr     _validate
	ldy     #$02
	sta     (c_sp),y
	lda     (c_sp),y
	bne     L0007
	ldy     #$04
	lda     (c_sp),y
	dey
	ora     (c_sp),y
	bne     L0003
	ldy     #$08
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _dir_sdi
	ldy     #$02
	jmp     L000C
L0003:	iny
	jsr     ldaxysp
	ldy     #$09
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$00
	tay
	sta     (ptr1),y
	ldy     #$08
	jsr     pushwysp
	ldx     #$00
	txa
	jsr     _dir_read
	ldy     #$02
	sta     (c_sp),y
	cmp     #$04
	bne     L000E
	lda     #$00
	sta     (c_sp),y
L000E:	lda     (c_sp),y
	bne     L0007
	ldy     #$08
	jsr     pushwysp
	ldy     #$06
	jsr     ldaxysp
	jsr     _get_fileinfo
	ldy     #$08
	jsr     pushwysp
	ldx     #$00
	txa
	jsr     _dir_next
	ldy     #$02
	sta     (c_sp),y
	cmp     #$04
	bne     L0007
	lda     #$00
L000C:	sta     (c_sp),y
L0007:	ldy     #$04
	lda     (c_sp),y
	dey
	ora     (c_sp),y
	beq     L0008
	dey
	lda     (c_sp),y
	beq     L0010
	ldy     #$04
	jsr     ldaxysp
	ldy     #$09
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$00
	tay
	sta     (ptr1),y
L0008:	ldy     #$02
L0010:	tax
	lda     (c_sp),y
	jmp     incsp7

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_mkdir (const char *path)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_mkdir: near

.segment	"CODE"

	jsr     pushax
	ldy     #$45
	jsr     subysp
	lda     #$45
	jsr     leaa0sp
	jsr     pushax
	lda     #$44
	jsr     leaa0sp
	jsr     pushax
	lda     #$02
	jsr     _mount_volume
	ldy     #$44
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L0017
	dey
	jsr     ldaxysp
	ldy     #$1A
	jsr     staxysp
	lda     #$1A
	jsr     leaa0sp
	jsr     pushax
	ldy     #$48
	jsr     ldaxysp
	jsr     _follow_path
	ldy     #$44
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0013
	ldy     #$41
	lda     (c_sp),y
	and     #$A0
	beq     L0010
	lda     #$06
	jmp     L0011
L0010:	lda     #$08
L0011:	ldy     #$44
	sta     (c_sp),y
L0013:	lda     (c_sp),y
	cmp     #$04
	jne     L0017
	dey
	jsr     ldaxysp
	ldy     #$0C
	jsr     staxysp
	lda     #$0C
	jsr     leaa0sp
	jsr     pushax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _create_chain
	ldy     #$08
	jsr     steaxysp
	lda     #$00
	ldy     #$44
	sta     (c_sp),y
	ldy     #$0B
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0007
	lda     #$07
	ldy     #$44
	sta     (c_sp),y
L0007:	ldy     #$0B
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	jsr     toseqeax
	beq     L0008
	lda     #$02
	ldy     #$44
	sta     (c_sp),y
L0008:	ldy     #$0B
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0009
	lda     #$01
	ldy     #$44
	sta     (c_sp),y
L0009:	jsr     _get_fattime
	jsr     steax0sp
	ldy     #$44
	lda     (c_sp),y
	jne     L0015
	iny
	jsr     pushwysp
	ldy     #$0D
	jsr     ldeaxysp
	jsr     _dir_clear
	ldy     #$44
	sta     (c_sp),y
	lda     (c_sp),y
	jne     L0015
	dey
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	lda     #$20
	jsr     pusha0
	lda     #$0B
	jsr     _memset
	ldy     #$43
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$2E
	ldy     #$00
	sta     (ptr1),y
	ldy     #$43
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$10
	ldy     #$00
	sta     (ptr1),y
	ldy     #$43
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$16
	jsr     incaxy
	jsr     pushax
	ldy     #$05
	jsr     ldeaxysp
	jsr     _st_32
	ldy     #$45
	jsr     pushwysp
	ldy     #$45
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$0F
	jsr     ldeaxysp
	jsr     _st_clust
	ldy     #$43
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$20
	jsr     incaxy
	jsr     pushax
	ldy     #$45
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldx     #$00
	lda     #$20
	jsr     _memcpy
	ldy     #$43
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$21
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$2E
	ldy     #$00
	sta     (ptr1),y
	ldy     #$23
	jsr     ldeaxysp
	ldy     #$04
	jsr     steaxysp
	ldy     #$45
	jsr     pushwysp
	ldy     #$45
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$20
	jsr     incaxy
	jsr     pushax
	ldy     #$0B
	jsr     ldeaxysp
	jsr     _st_clust
	ldy     #$43
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$04
	sta     (ptr1),y
	lda     #$1A
	jsr     leaa0sp
	jsr     _dir_register
	ldy     #$44
	sta     (c_sp),y
L0015:	lda     (c_sp),y
	bne     L000D
	ldy     #$35
	jsr     ldaxysp
	ldy     #$0E
	jsr     incaxy
	jsr     pushax
	ldy     #$05
	jsr     ldeaxysp
	jsr     _st_32
	ldy     #$35
	jsr     ldaxysp
	ldy     #$16
	jsr     incaxy
	jsr     pushax
	ldy     #$05
	jsr     ldeaxysp
	jsr     _st_32
	ldy     #$45
	jsr     pushwysp
	ldy     #$39
	jsr     pushwysp
	ldy     #$0F
	jsr     ldeaxysp
	jsr     _st_clust
	ldy     #$35
	jsr     ldaxysp
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$10
	ldy     #$00
	sta     (ptr1),y
	ldy     #$43
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$04
	sta     (ptr1),y
	ldy     #$44
	ldx     #$00
	lda     (c_sp),y
	bne     L0017
	dey
	jsr     ldaxysp
	jsr     _sync_fs
	ldy     #$44
	sta     (c_sp),y
	jmp     L0016
L000D:	lda     #$0C
	jsr     leaa0sp
	jsr     pushax
	ldy     #$0D
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _remove_chain
	ldy     #$44
L0016:	ldx     #$00
L0017:	lda     (c_sp),y
	ldy     #$47
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_unlink (const char *path)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_unlink: near

.segment	"CODE"

	jsr     pushax
	ldy     #$53
	jsr     subysp
	jsr     pushl0
	lda     #$57
	jsr     leaa0sp
	jsr     pushax
	lda     #$56
	jsr     leaa0sp
	jsr     pushax
	lda     #$02
	jsr     _mount_volume
	ldy     #$56
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L001B
	dey
	jsr     ldaxysp
	ldy     #$2C
	jsr     staxysp
	lda     #$2C
	jsr     leaa0sp
	jsr     pushax
	ldy     #$5A
	jsr     ldaxysp
	jsr     _follow_path
	ldy     #$56
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0014
	ldy     #$53
	lda     (c_sp),y
	and     #$A0
	beq     L0004
	lda     #$06
	jmp     L001C
L0004:	ldy     #$30
	lda     (c_sp),y
	and     #$01
	beq     L0006
	lda     #$07
L001C:	ldy     #$56
	sta     (c_sp),y
L0006:	ldy     #$56
L0014:	lda     (c_sp),y
	bne     L0018
	iny
	jsr     pushwysp
	ldy     #$49
	jsr     ldaxysp
	jsr     _ld_clust
	jsr     steax0sp
	ldy     #$30
	lda     (c_sp),y
	and     #$10
	beq     L000B
	ldy     #$55
	jsr     ldaxysp
	ldy     #$04
	jsr     staxysp
	jsr     ldeax0sp
	ldy     #$0A
	jsr     steaxysp
	lda     #$04
	jsr     leaa0sp
	jsr     pushax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _dir_sdi
	ldy     #$56
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0018
	lda     #$04
	jsr     leaa0sp
	jsr     pushax
	ldx     #$00
	txa
	jsr     _dir_read
	ldy     #$56
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0016
	lda     #$07
	sta     (c_sp),y
L0016:	lda     (c_sp),y
	cmp     #$04
	bne     L0018
	txa
	sta     (c_sp),y
L000B:	ldy     #$56
	tax
L0018:	lda     (c_sp),y
	bne     L001B
	lda     #$2C
	jsr     leaa0sp
	jsr     _dir_remove
	ldy     #$56
	sta     (c_sp),y
	lda     (c_sp),y
	bne     L001D
	jsr     ldeax0sp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     tosneeax
	beq     L000D
	lda     #$2C
	jsr     leaa0sp
	jsr     pushax
	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _remove_chain
	ldy     #$56
	sta     (c_sp),y
L000D:	ldy     #$56
L001D:	ldx     #$00
	lda     (c_sp),y
	bne     L001B
	dey
	jsr     ldaxysp
	jsr     _sync_fs
	ldy     #$56
	sta     (c_sp),y
	ldx     #$00
L001B:	lda     (c_sp),y
	ldy     #$59
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_rename (const char *path_old, const char *path_new)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_rename: near

.segment	"CODE"

	jsr     pushax
	ldy     #$75
	jsr     subysp
	lda     #$75
	jsr     leaa0sp
	jsr     _get_ldnumber
	lda     #$77
	jsr     leaa0sp
	jsr     pushax
	lda     #$74
	jsr     leaa0sp
	jsr     pushax
	lda     #$02
	jsr     _mount_volume
	ldy     #$74
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L0028
	dey
	jsr     ldaxysp
	ldy     #$4A
	jsr     staxysp
	lda     #$4A
	jsr     leaa0sp
	jsr     pushax
	ldy     #$7A
	jsr     ldaxysp
	jsr     _follow_path
	ldy     #$74
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L001C
	ldy     #$71
	lda     (c_sp),y
	and     #$A0
	beq     L0004
	lda     #$06
	ldy     #$74
	sta     (c_sp),y
L0004:	ldy     #$74
L001C:	lda     (c_sp),y
	jne     L0028
	lda     #$02
	jsr     leaa0sp
	jsr     pushax
	ldy     #$69
	jsr     pushwysp
	ldx     #$00
	lda     #$20
	jsr     _memcpy
	lda     #$22
	jsr     leaa0sp
	jsr     pushax
	lda     #$4C
	jsr     leaa0sp
	jsr     pushax
	ldx     #$00
	lda     #$28
	jsr     _memcpy
	lda     #$22
	jsr     leaa0sp
	jsr     pushax
	ldy     #$78
	jsr     ldaxysp
	jsr     _follow_path
	ldy     #$74
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0020
	ldy     #$2B
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$57
	jsr     ldeaxysp
	jsr     toseqeax
	beq     L001D
	ldy     #$33
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$5F
	jsr     ldeaxysp
	jsr     toseqeax
	beq     L001D
	lda     #$04
	jmp     L001E
L001D:	lda     #$08
L001E:	ldy     #$74
	sta     (c_sp),y
	ldx     #$00
L0020:	lda     (c_sp),y
	cmp     #$04
	jne     L0026
	lda     #$22
	jsr     leaa0sp
	jsr     _dir_register
	ldy     #$74
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L0026
	ldy     #$3D
	jsr     ldaxysp
	jsr     stax0sp
	ldy     #$0D
	jsr     incaxy
	jsr     pushax
	lda     #$11
	jsr     leaa0sp
	jsr     pushax
	ldx     #$00
	lda     #$13
	jsr     _memcpy
	jsr     ldax0sp
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$0D
	lda     (c_sp),y
	ldy     #$00
	sta     (ptr1),y
	jsr     ldax0sp
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	and     #$10
	bne     L000E
	jsr     ldax0sp
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	ora     #$20
	sta     (ptr1),y
L000E:	ldy     #$73
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$04
	sta     (ptr1),y
	jsr     ldax0sp
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	and     #$10
	jeq     L000F
	ldy     #$53
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$2F
	jsr     ldeaxysp
	jsr     tosneeax
	jeq     L000F
	ldy     #$75
	jsr     pushwysp
	ldy     #$77
	jsr     pushwysp
	ldy     #$05
	jsr     ldaxysp
	jsr     _ld_clust
	jsr     _clst2sect
	jsr     pusheax
	jsr     ldeax0sp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0013
	lda     #$02
	ldy     #$78
	sta     (c_sp),y
	jmp     L0015
L0013:	ldy     #$79
	jsr     pushwysp
	ldy     #$05
	jsr     ldeaxysp
	jsr     _move_window
	ldy     #$78
	sta     (c_sp),y
	dey
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$20
	jsr     incaxy
	ldy     #$04
	jsr     staxysp
	ldy     #$78
	lda     (c_sp),y
	bne     L0015
	ldy     #$05
	jsr     ldaxysp
	jsr     incax1
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	cmp     #$2E
	bne     L0015
	ldy     #$79
	jsr     pushwysp
	ldy     #$09
	jsr     pushwysp
	ldy     #$33
	jsr     ldeaxysp
	jsr     _st_clust
	ldy     #$77
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$04
	sta     (ptr1),y
L0015:	jsr     incsp4
L000F:	ldy     #$74
	ldx     #$00
L0026:	lda     (c_sp),y
	bne     L0028
	lda     #$4A
	jsr     leaa0sp
	jsr     _dir_remove
	ldy     #$74
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0028
	dey
	jsr     ldaxysp
	jsr     _sync_fs
	ldy     #$74
	sta     (c_sp),y
	ldx     #$00
L0028:	lda     (c_sp),y
	ldy     #$79
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_stat (const char *path, struct $anon-struct-0005 *fno)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_stat: near

.segment	"CODE"

	jsr     pushax
	ldy     #$29
	jsr     subysp
	lda     #$2B
	jsr     leaa0sp
	jsr     pushax
	lda     #$02
	jsr     leaa0sp
	jsr     pushax
	lda     #$00
	jsr     _mount_volume
	ldy     #$28
	sta     (c_sp),y
	lda     (c_sp),y
	bne     L0006
	lda     c_sp
	ldx     c_sp+1
	jsr     pushax
	ldy     #$2E
	jsr     ldaxysp
	jsr     _follow_path
	ldy     #$28
	sta     (c_sp),y
	lda     (c_sp),y
	bne     L0006
	dey
	lda     (c_sp),y
	and     #$80
	beq     L0004
	lda     #$06
	iny
	sta     (c_sp),y
	jmp     L0006
L0004:	ldy     #$2A
	lda     (c_sp),y
	dey
	ora     (c_sp),y
	beq     L0006
	lda     c_sp
	ldx     c_sp+1
	jsr     pushax
	ldy     #$2C
	jsr     ldaxysp
	jsr     _get_fileinfo
L0006:	ldy     #$2A
	lda     (c_sp),y
	dey
	ora     (c_sp),y
	beq     L0007
	dey
	lda     (c_sp),y
	beq     L000C
	ldy     #$2A
	jsr     ldaxysp
	ldy     #$09
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$00
	tay
	sta     (ptr1),y
L0007:	ldy     #$28
L000C:	tax
	lda     (c_sp),y
	ldy     #$2D
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_getfree (const char *path, unsigned long *nclst, struct $anon-struct-0001 **fatfs)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_getfree: near

.segment	"CODE"

	jsr     pushax
	ldy     #$23
	jsr     subysp
	lda     #$27
	jsr     leaa0sp
	jsr     pushax
	lda     #$22
	jsr     leaa0sp
	jsr     pushax
	lda     #$00
	jsr     _mount_volume
	ldy     #$22
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L001D
	ldy     #$24
	jsr     ldptr1ysp
	ldy     #$21
	jsr     ldaxysp
	ldy     #$00
	sta     (ptr1),y
	iny
	txa
	sta     (ptr1),y
	ldy     #$21
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$25
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	ldy     #$02
	jsr     deceaxy
	jsr     tosuleeax
	beq     L0003
	ldy     #$28
	jsr     pushwysp
	ldy     #$23
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	ldy     #$00
	jsr     steaxspidx
	jmp     L0018
L0003:	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	ldy     #$1C
	jsr     steaxysp
	ldy     #$21
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	cmp     #$01
	jne     L0005
	lda     #$02
	ldx     #$00
	ldy     #$18
	jsr     steaxysp
	ldy     #$21
	jsr     ldaxysp
	jsr     stax0sp
L0006:	lda     c_sp
	ldx     c_sp+1
	jsr     pushax
	ldy     #$1D
	jsr     ldeaxysp
	jsr     _get_fat
	ldy     #$14
	jsr     steaxysp
	ldy     #$17
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0009
	ldx     #$00
	lda     #$01
	ldy     #$22
	sta     (c_sp),y
	jmp     L001B
L0009:	ldy     #$17
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	jsr     toseqeax
	beq     L000A
	ldx     #$00
	lda     #$02
	ldy     #$22
	sta     (c_sp),y
	jmp     L001B
L000A:	ldy     #$17
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L000B
	lda     #$01
	ldx     #$00
	ldy     #$1C
	jsr     laddeqysp
L000B:	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	ldy     #$18
	jsr     laddeqysp
	jsr     pusheax
	ldy     #$25
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosulteax
	jne     L0006
	jmp     L000E
L0005:	ldy     #$21
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	ldy     #$18
	jsr     steaxysp
	ldy     #$21
	jsr     ldaxysp
	ldy     #$27
	jsr     ldeaxidx
	ldy     #$10
	jsr     steaxysp
	ldx     #$00
	txa
	ldy     #$0E
	jsr     staxysp
L000D:	ldy     #$0E
	lda     (c_sp),y
	iny
	ora     (c_sp),y
	bne     L0012
	ldy     #$23
	jsr     pushwysp
	ldy     #$15
	jsr     ldeaxysp
	jsr     saveeax
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	ldy     #$12
	jsr     laddeqysp
	jsr     resteax
	jsr     _move_window
	ldy     #$22
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L001B
L0012:	ldy     #$21
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	cmp     #$02
	bne     L0013
	ldy     #$21
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$0F
	jsr     ldaxysp
	clc
	adc     ptr1
	pha
	txa
	adc     ptr1+1
	tax
	pla
	jsr     _ld_16
	cpx     #$00
	bne     L0014
	cmp     #$00
	bne     L0014
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldy     #$1C
	jsr     laddeqysp
L0014:	ldy     #$0E
	ldx     #$00
	lda     #$02
	jmp     L0019
L0013:	ldy     #$21
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$0F
	jsr     ldaxysp
	clc
	adc     ptr1
	pha
	txa
	adc     ptr1+1
	tax
	pla
	jsr     _ld_32
	jsr     pusheax
	lda     #$0F
	sta     sreg+1
	lda     #$FF
	sta     sreg
	tax
	jsr     tosandeax
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0017
	lda     #$01
	ldx     #$00
	ldy     #$1C
	jsr     laddeqysp
L0017:	ldy     #$0E
	ldx     #$00
	lda     #$04
L0019:	jsr     addeqysp
	ldy     #$0F
	jsr     ldaxysp
	tay
	txa
	and     #$01
	tax
	tya
	ldy     #$0E
	jsr     staxysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	ldy     #$18
	jsr     lsubeqysp
	jsr     utsteax
	jne     L000D
L000E:	ldy     #$22
	ldx     #$00
L001B:	lda     (c_sp),y
	bne     L001D
	ldy     #$28
	jsr     pushwysp
	ldy     #$21
	jsr     ldeaxysp
	ldy     #$00
	jsr     steaxspidx
	ldy     #$23
	jsr     pushwysp
	ldy     #$21
	jsr     ldeaxysp
	ldy     #$10
	jsr     steaxspidx
	ldy     #$21
	jsr     ldptr1ysp
	ldy     #$05
	lda     (ptr1),y
	ora     #$01
	sta     (ptr1),y
L0018:	ldy     #$22
	ldx     #$00
L001D:	lda     (c_sp),y
	ldy     #$29
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ f_mount (struct $anon-struct-0001 *fs, const char *path, unsigned char opt)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_f_mount: near

.segment	"CODE"

	jsr     pusha
	jsr     decsp5
	ldy     #$09
	jsr     pushwysp
	lda     c_sp
	ldx     c_sp+1
	jsr     _get_ldnumber
	ldy     #$03
	jsr     staxysp
	cpx     #$80
	bcc     L0002
	ldx     #$00
	lda     #$0B
	jmp     L0001
L0002:	ldy     #$04
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_FatFs)
	tay
	txa
	adc     #>(_FatFs)
	tax
	tya
	jsr     ldaxi
	ldy     #$05
	jsr     staxysp
	ldy     #$06
	lda     (c_sp),y
	dey
	ora     (c_sp),y
	beq     L0003
	dey
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_FatFs)
	sta     ptr1
	txa
	adc     #>(_FatFs)
	sta     ptr1+1
	lda     #$00
	tay
	sta     (ptr1),y
	iny
	sta     (ptr1),y
	ldy     #$06
	jsr     ldptr1ysp
	lda     #$00
	tay
	sta     (ptr1),y
L0003:	ldy     #$0B
	lda     (c_sp),y
	dey
	ora     (c_sp),y
	beq     L0004
	iny
	jsr     ldptr1ysp
	ldy     #$03
	lda     (c_sp),y
	ldy     #$01
	sta     (ptr1),y
	ldy     #$0B
	jsr     ldptr1ysp
	lda     #$00
	tay
	sta     (ptr1),y
	ldy     #$04
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_FatFs)
	sta     ptr1
	txa
	adc     #>(_FatFs)
	sta     ptr1+1
	ldy     #$0B
	jsr     ldaxysp
	ldy     #$00
	sta     (ptr1),y
	iny
	txa
	sta     (ptr1),y
L0004:	ldy     #$07
	lda     (c_sp),y
	bne     L0005
	tax
	jmp     L0001
L0005:	lda     #$08
	jsr     leaa0sp
	jsr     pushax
	lda     #$0C
	jsr     leaa0sp
	jsr     pushax
	lda     #$00
	jsr     _mount_volume
	ldy     #$02
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
L0001:	ldy     #$0C
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; unsigned short __near__ ld_16 (const unsigned char *ptr)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_ld_16: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp2
	ldy     #$03
	jsr     ldaxysp
	jsr     incax1
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	ldx     #$00
	lda     (ptr1),y
	jsr     stax0sp
	sta     sreg+1
	ldy     #$03
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	ldx     sreg+1
	jsr     stax0sp
	jmp     incsp4

.endproc

; ---------------------------------------------------------------
; unsigned long __near__ ld_32 (const unsigned char *ptr)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_ld_32: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp4
	ldy     #$05
	jsr     ldaxysp
	jsr     incax3
	sta     ptr1
	stx     ptr1+1
	ldx     #$00
	lda     (ptr1,x)
	jsr     axulong
	jsr     steax0sp
	jsr     ldeax0sp
	ldy     sreg
	sty     sreg+1
	stx     sreg
	tax
	lda     #$00
	jsr     pusheax
	ldy     #$09
	jsr     ldaxysp
	jsr     incax2
	sta     ptr1
	stx     ptr1+1
	ldx     #$00
	lda     (ptr1,x)
	jsr     axulong
	jsr     tosoreax
	jsr     steax0sp
	jsr     ldeax0sp
	ldy     sreg
	sty     sreg+1
	stx     sreg
	tax
	lda     #$00
	jsr     pusheax
	ldy     #$09
	jsr     ldaxysp
	jsr     incax1
	sta     ptr1
	stx     ptr1+1
	ldx     #$00
	lda     (ptr1,x)
	jsr     axulong
	jsr     tosoreax
	jsr     steax0sp
	jsr     ldeax0sp
	ldy     sreg
	sty     sreg+1
	stx     sreg
	tax
	lda     #$00
	jsr     pusheax
	ldy     #$09
	jsr     ldptr1ysp
	ldx     #$00
	lda     (ptr1,x)
	jsr     axulong
	jsr     tosoreax
	jsr     steax0sp
	jsr     ldeax0sp
	jmp     incsp6

.endproc

; ---------------------------------------------------------------
; void __near__ st_16 (unsigned char *ptr, unsigned short val)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_st_16: near

.segment	"CODE"

	jsr     pushax
	ldy     #$03
	jsr     ldptr1ysp
	ldy     #$00
	lda     (c_sp),y
	sta     (ptr1),y
	ldy     #$02
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	jsr     ldax0sp
	txa
	ldx     #$00
	jsr     stax0sp
	ldy     #$03
	jsr     ldptr1ysp
	ldy     #$00
	lda     (c_sp),y
	sta     (ptr1),y
	ldy     #$02
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	jmp     incsp4

.endproc

; ---------------------------------------------------------------
; void __near__ st_32 (unsigned char *ptr, unsigned long val)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_st_32: near

.segment	"CODE"

	jsr     pusheax
	ldy     #$05
	jsr     ldptr1ysp
	ldy     #$00
	lda     (c_sp),y
	sta     (ptr1),y
	ldy     #$04
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	jsr     ldeax0sp
	txa
	ldx     sreg
	ldy     sreg+1
	sty     sreg
	ldy     #$00
	sty     sreg+1
	jsr     steax0sp
	ldy     #$05
	jsr     ldptr1ysp
	ldy     #$00
	lda     (c_sp),y
	sta     (ptr1),y
	ldy     #$04
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	jsr     ldeax0sp
	txa
	ldx     sreg
	ldy     sreg+1
	sty     sreg
	ldy     #$00
	sty     sreg+1
	jsr     steax0sp
	ldy     #$05
	jsr     ldptr1ysp
	ldy     #$00
	lda     (c_sp),y
	sta     (ptr1),y
	ldy     #$04
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	jsr     ldeax0sp
	txa
	ldx     sreg
	ldy     sreg+1
	sty     sreg
	ldy     #$00
	sty     sreg+1
	jsr     steax0sp
	ldy     #$05
	jsr     ldptr1ysp
	ldy     #$00
	lda     (c_sp),y
	sta     (ptr1),y
	ldy     #$04
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	jmp     incsp6

.endproc

; ---------------------------------------------------------------
; int __near__ dbc_1st (unsigned char c)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_dbc_1st: near

.segment	"CODE"

	jsr     pusha
	ldx     #$00
	lda     (c_sp,x)
	beq     L0004
	txa
L0004:	jmp     incsp1

.endproc

; ---------------------------------------------------------------
; int __near__ dbc_2nd (unsigned char c)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_dbc_2nd: near

.segment	"CODE"

	jsr     pusha
	ldx     #$00
	lda     (c_sp,x)
	beq     L0004
	txa
L0004:	jmp     incsp1

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ sync_window (struct $anon-struct-0001 *fs)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_sync_window: near

.segment	"CODE"

	jsr     pushax
	lda     #$00
	jsr     pusha
	ldy     #$02
	jsr     ldptr1ysp
	ldy     #$04
	lda     (ptr1),y
	jeq     L0006
	ldy     #$02
	jsr     ldptr1ysp
	ldy     #$01
	lda     (ptr1),y
	jsr     pusha
	ldy     #$03
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$1F
	jsr     ldeaxidx
	jsr     pusheax
	ldx     #$00
	lda     #$01
	jsr     _disk_write
	cmp     #$00
	jne     L0003
	ldy     #$02
	jsr     ldptr1ysp
	lda     #$00
	ldy     #$04
	sta     (ptr1),y
	ldy     #$02
	jsr     ldaxysp
	ldy     #$1F
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$06
	jsr     ldaxysp
	ldy     #$27
	jsr     ldeaxidx
	jsr     tossubeax
	jsr     pusheax
	ldy     #$06
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldeaxidx
	jsr     tosulteax
	beq     L0006
	ldy     #$02
	jsr     ldptr1ysp
	ldy     #$03
	lda     (ptr1),y
	cmp     #$02
	bne     L0006
	dey
	jsr     ldptr1ysp
	ldy     #$01
	lda     (ptr1),y
	jsr     pusha
	ldy     #$03
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$1F
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$09
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldeaxidx
	jsr     tosaddeax
	jsr     pusheax
	ldx     #$00
	lda     #$01
	jsr     _disk_write
	jmp     L0006
L0003:	lda     #$01
	ldy     #$00
	sta     (c_sp),y
L0006:	ldx     #$00
	lda     (c_sp,x)
	jmp     incsp3

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ move_window (struct $anon-struct-0001 *fs, unsigned long sect)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_move_window: near

.segment	"CODE"

	jsr     pusheax
	lda     #$00
	jsr     pusha
	ldy     #$04
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$1F
	jsr     ldeaxidx
	jsr     tosneeax
	beq     L0003
	ldy     #$06
	jsr     ldaxysp
	jsr     _sync_window
	ldy     #$00
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0006
	ldy     #$06
	jsr     ldptr1ysp
	ldy     #$01
	lda     (ptr1),y
	jsr     pusha
	ldy     #$07
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$07
	jsr     ldeaxysp
	jsr     pusheax
	ldx     #$00
	lda     #$01
	jsr     _disk_read
	cmp     #$00
	beq     L0004
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	ldy     #$01
	jsr     steaxysp
	lda     #$01
	ldy     #$00
	sta     (c_sp),y
L0004:	ldy     #$08
	jsr     pushwysp
	ldy     #$06
	jsr     ldeaxysp
	ldy     #$1C
	jsr     steaxspidx
L0003:	ldx     #$00
L0006:	lda     (c_sp,x)
	jmp     incsp7

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ sync_fs (struct $anon-struct-0001 *fs)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_sync_fs: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp1
	ldy     #$02
	jsr     ldaxysp
	jsr     _sync_window
	ldy     #$00
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L0007
	ldy     #$02
	jsr     ldptr1ysp
	ldy     #$05
	lda     (ptr1),y
	cmp     #$01
	jne     L0004
	ldy     #$02
	jsr     ldptr1ysp
	lda     #$00
	ldy     #$05
	sta     (ptr1),y
	ldy     #$02
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	cmp     #$03
	jne     L0004
	ldy     #$02
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldx     #$02
	lda     #$00
	jsr     ___bzero
	ldy     #$02
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	lda     #$41
	sta     sreg+1
	lda     #$61
	sta     sreg
	lda     #$52
	tax
	jsr     _st_32
	ldy     #$02
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$E4
	clc
	adc     ptr1
	pha
	lda     #$01
	adc     ptr1+1
	tax
	pla
	jsr     pushax
	lda     #$61
	sta     sreg+1
	lda     #$41
	sta     sreg
	lda     #$72
	tax
	jsr     _st_32
	ldy     #$02
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$E8
	clc
	adc     ptr1
	pha
	lda     #$01
	adc     ptr1+1
	tax
	pla
	jsr     pushax
	ldy     #$04
	jsr     ldaxysp
	ldy     #$13
	jsr     ldeaxidx
	jsr     _st_32
	ldy     #$02
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$EC
	clc
	adc     ptr1
	pha
	lda     #$01
	adc     ptr1+1
	tax
	pla
	jsr     pushax
	ldy     #$04
	jsr     ldaxysp
	ldy     #$0F
	jsr     ldeaxidx
	jsr     _st_32
	ldy     #$02
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$FC
	clc
	adc     ptr1
	pha
	lda     #$01
	adc     ptr1+1
	tax
	pla
	jsr     pushax
	lda     #$AA
	sta     sreg+1
	lda     #$55
	sta     sreg
	lda     #$00
	tax
	jsr     _st_32
	ldy     #$02
	jsr     ldptr1ysp
	ldy     #$01
	lda     (ptr1),y
	jsr     pusha
	ldy     #$03
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$07
	jsr     pushwysp
	ldy     #$07
	jsr     ldaxysp
	ldy     #$23
	jsr     ldeaxidx
	ldy     #$01
	jsr     inceaxy
	ldy     #$1C
	jsr     steaxspidx
	jsr     pusheax
	ldx     #$00
	lda     #$01
	jsr     _disk_write
L0004:	ldy     #$02
	jsr     ldptr1ysp
	ldy     #$01
	lda     (ptr1),y
	jsr     pusha
	lda     #$00
	jsr     pusha
	tax
	jsr     _disk_ioctl
	cmp     #$00
	beq     L0005
	lda     #$01
	ldy     #$00
	sta     (c_sp),y
L0005:	ldx     #$00
L0007:	lda     (c_sp,x)
	jmp     incsp3

.endproc

; ---------------------------------------------------------------
; unsigned long __near__ clst2sect (struct $anon-struct-0001 *fs, unsigned long clst)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_clst2sect: near

.segment	"CODE"

	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$02
	ldx     #$00
	jsr     lsubeq0sp
	jsr     ldeax0sp
	jsr     pusheax
	ldy     #$09
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	ldy     #$02
	jsr     deceaxy
	jsr     tosugeeax
	beq     L0002
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jmp     incsp6
L0002:	ldy     #$05
	jsr     ldaxysp
	ldy     #$2F
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$09
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	jsr     axulong
	jsr     pusheax
	ldy     #$0B
	jsr     ldeaxysp
	jsr     tosumuleax
	jsr     tosaddeax
	jmp     incsp6

.endproc

; ---------------------------------------------------------------
; unsigned long __near__ get_fat (struct $anon-struct-0002 *obj, unsigned long clst)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_get_fat: near

.segment	"CODE"

	jsr     pusheax
	jsr     decsp8
	ldy     #$0D
	jsr     ldaxysp
	jsr     pushw
	ldy     #$0D
	jsr     ldeaxysp
	cmp     #$02
	txa
	sbc     #$00
	lda     sreg
	sbc     #$00
	lda     sreg+1
	sbc     #$00
	jcc     L0011
	ldy     #$0D
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosugeeax
	jne     L0011
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	ldy     #$02
	jsr     steaxysp
	jsr     ldptr10sp
	ldy     #$00
	lda     (ptr1),y
	cmp     #$01
	beq     L0008
	cmp     #$02
	jeq     L000D
	cmp     #$03
	jeq     L000F
	jmp     L0011
L0008:	ldy     #$0B
	jsr     ldaxysp
	ldy     #$06
	jsr     staxysp
	jsr     shrax1
	ldy     #$06
	jsr     addeqysp
	jsr     pushw0sp
	ldy     #$03
	jsr     ldaxysp
	ldy     #$27
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$0D
	jsr     ldaxysp
	txa
	ldx     #$00
	lsr     a
	jsr     axulong
	jsr     tosaddeax
	jsr     _move_window
	cmp     #$00
	jne     L0007
	jsr     ldax0sp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$07
	jsr     ldaxysp
	tay
	txa
	and     #$01
	tax
	tya
	clc
	adc     ptr1
	sta     ptr1
	txa
	adc     ptr1+1
	sta     ptr1+1
	ldx     #$00
	lda     (ptr1,x)
	ldy     #$08
	jsr     staxysp
	ldy     #$06
	lda     #$01
	jsr     addeqysp
	jsr     pushw0sp
	ldy     #$03
	jsr     ldaxysp
	ldy     #$27
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$0D
	jsr     ldaxysp
	txa
	ldx     #$00
	lsr     a
	jsr     axulong
	jsr     tosaddeax
	jsr     _move_window
	cmp     #$00
	jne     L0007
	jsr     ldax0sp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$07
	jsr     ldaxysp
	tay
	txa
	and     #$01
	tax
	tya
	clc
	adc     ptr1
	sta     ptr1
	txa
	adc     ptr1+1
	sta     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	tax
	ldy     #$08
	lda     (c_sp),y
	pha
	txa
	iny
	ora     (c_sp),y
	tax
	pla
	dey
	jsr     staxysp
	ldy     #$0D
	jsr     ldeaxysp
	ldx     #$00
	stx     sreg+1
	stx     sreg
	and     #$01
	jsr     utsteax
	beq     L000B
	ldy     #$09
	jsr     ldaxysp
	jsr     shrax4
	jmp     L000C
L000B:	ldy     #$09
	jsr     ldaxysp
	tay
	txa
	and     #$0F
	tax
	tya
L000C:	jsr     axulong
	jmp     L0013
L000D:	jsr     pushw0sp
	ldy     #$03
	jsr     ldaxysp
	ldy     #$27
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$13
	jsr     ldeaxysp
	txa
	ldx     sreg
	ldy     sreg+1
	sty     sreg
	ldy     #$00
	sty     sreg+1
	jsr     tosaddeax
	jsr     _move_window
	cmp     #$00
	jne     L0007
	jsr     ldax0sp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$0F
	jsr     ldeaxysp
	jsr     shleax1
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     tosaddax
	jsr     _ld_16
	jsr     axulong
	jmp     L0013
L000F:	jsr     pushw0sp
	ldy     #$03
	jsr     ldaxysp
	ldy     #$27
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$13
	jsr     ldeaxysp
	jsr     shreax4
	jsr     shreax3
	jsr     tosaddeax
	jsr     _move_window
	cmp     #$00
	bne     L0007
	jsr     ldax0sp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$0F
	jsr     ldeaxysp
	jsr     shleax2
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     tosaddax
	jsr     _ld_32
	jsr     pusheax
	lda     #$0F
	sta     sreg+1
	lda     #$FF
	sta     sreg
	tax
	jsr     tosandeax
	jmp     L0013
L0011:	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
L0013:	ldy     #$02
	jsr     steaxysp
L0007:	ldy     #$05
	jsr     ldeaxysp
	ldy     #$10
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ put_fat (struct $anon-struct-0001 *fs, unsigned long clst, unsigned long val)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_put_fat: near

.segment	"CODE"

	jsr     pusheax
	jsr     decsp4
	lda     #$02
	jsr     pusha
	ldy     #$0C
	jsr     ldeaxysp
	cmp     #$02
	txa
	sbc     #$00
	lda     sreg
	sbc     #$00
	lda     sreg+1
	sbc     #$00
	jcc     L0007
	ldy     #$0C
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$12
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosulteax
	jeq     L0007
	ldy     #$0E
	jsr     ldptr1ysp
	ldx     #$00
	lda     (ptr1,x)
	cmp     #$01
	beq     L0008
	cmp     #$02
	jeq     L000F
	cmp     #$03
	jeq     L0011
	jmp     L0019
L0008:	ldy     #$0A
	jsr     ldaxysp
	ldy     #$03
	jsr     staxysp
	jsr     shrax1
	ldy     #$03
	jsr     addeqysp
	ldy     #$10
	jsr     pushwysp
	ldy     #$10
	jsr     ldaxysp
	ldy     #$27
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$0A
	jsr     ldaxysp
	txa
	ldx     #$00
	lsr     a
	jsr     axulong
	jsr     tosaddeax
	jsr     _move_window
	ldy     #$00
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L0019
	ldy     #$0E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$04
	jsr     ldaxysp
	tay
	txa
	and     #$01
	tax
	tya
	clc
	adc     ptr1
	pha
	txa
	adc     ptr1+1
	tax
	pla
	ldy     #$01
	jsr     staxysp
	ldy     #$03
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	ldy     #$02
	jsr     ldaxysp
	sta     ptr2
	stx     ptr2+1
	ldy     #$0C
	jsr     ldeaxysp
	ldx     #$00
	stx     sreg+1
	stx     sreg
	and     #$01
	jsr     utsteax
	beq     L000A
	ldy     #$02
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	and     #$0F
	sta     ptr1
	ldy     #$05
	lda     (c_sp),y
	asl     a
	asl     a
	asl     a
	asl     a
	ora     ptr1
	jmp     L000B
L000A:	ldy     #$05
	lda     (c_sp),y
L000B:	ldy     #$00
	sta     (ptr2),y
	ldy     #$0E
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$04
	sta     (ptr1),y
	ldy     #$10
	jsr     pushwysp
	ldy     #$10
	jsr     ldaxysp
	ldy     #$27
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$0A
	jsr     ldaxysp
	txa
	ldx     #$00
	lsr     a
	jsr     axulong
	jsr     tosaddeax
	jsr     _move_window
	ldy     #$00
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L0019
	ldy     #$0E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$04
	jsr     ldaxysp
	tay
	txa
	and     #$01
	tax
	tya
	clc
	adc     ptr1
	pha
	txa
	adc     ptr1+1
	tax
	pla
	ldy     #$01
	jsr     staxysp
	jsr     pushax
	ldy     #$0E
	jsr     ldeaxysp
	ldx     #$00
	stx     sreg+1
	stx     sreg
	and     #$01
	jsr     utsteax
	beq     L000D
	ldy     #$0A
	jsr     ldeaxysp
	jsr     shreax4
	jmp     L0017
L000D:	ldy     #$04
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	and     #$F0
	jsr     pusha0
	ldy     #$0C
	jsr     ldeaxysp
	txa
	and     #$0F
	jsr     tosora0
L0017:	ldy     #$00
	jsr     staspidx
	jmp     L001F
L000F:	ldy     #$10
	jsr     pushwysp
	ldy     #$10
	jsr     ldaxysp
	ldy     #$27
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$12
	jsr     ldeaxysp
	txa
	ldx     sreg
	ldy     sreg+1
	sty     sreg
	ldy     #$00
	sty     sreg+1
	jsr     tosaddeax
	jsr     _move_window
	ldy     #$00
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L0019
	ldy     #$0E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$0E
	jsr     ldeaxysp
	jsr     shleax1
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     tosaddax
	jsr     pushax
	ldy     #$08
	jsr     ldaxysp
	jsr     _st_16
	jmp     L001F
L0011:	ldy     #$10
	jsr     pushwysp
	ldy     #$10
	jsr     ldaxysp
	ldy     #$27
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$12
	jsr     ldeaxysp
	jsr     shreax4
	jsr     shreax3
	jsr     tosaddeax
	jsr     _move_window
	ldy     #$00
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L0019
	ldy     #$08
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$0F
	sta     sreg+1
	lda     #$FF
	sta     sreg
	tax
	jsr     tosandeax
	jsr     pusheax
	ldy     #$12
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$12
	jsr     ldeaxysp
	jsr     shleax2
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     tosaddax
	jsr     _ld_32
	jsr     pusheax
	lda     #$F0
	sta     sreg+1
	lda     #$00
	sta     sreg
	tax
	jsr     tosandeax
	jsr     tosoreax
	ldy     #$05
	jsr     steaxysp
	ldy     #$0E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$0E
	jsr     ldeaxysp
	jsr     shleax2
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     tosaddax
	jsr     pushax
	ldy     #$0A
	jsr     ldeaxysp
	jsr     _st_32
L001F:	ldy     #$0E
	jsr     ldptr1ysp
	lda     #$01
	ldy     #$04
	sta     (ptr1),y
L0007:	ldx     #$00
L0019:	lda     (c_sp,x)
	ldy     #$0F
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ remove_chain (struct $anon-struct-0002 *obj, unsigned long clst, unsigned long pclst)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_remove_chain: near

.segment	"CODE"

	jsr     pusheax
	lda     #$00
	jsr     pusha
	jsr     decsp4
	ldy     #$0E
	jsr     ldaxysp
	jsr     pushw
	ldy     #$0E
	jsr     ldeaxysp
	cmp     #$02
	txa
	sbc     #$00
	lda     sreg
	sbc     #$00
	lda     sreg+1
	sbc     #$00
	bcc     L0003
	ldy     #$0E
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosugeeax
	beq     L0002
L0003:	ldx     #$00
	lda     #$02
	jmp     L0001
L0002:	ldy     #$0A
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     tosneeax
	beq     L0009
	jsr     pushw0sp
	ldy     #$0C
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     _put_fat
	ldy     #$06
	sta     (c_sp),y
	lda     (c_sp),y
	beq     L0009
	ldx     #$00
	lda     (c_sp),y
	jmp     L0001
L0009:	ldy     #$12
	jsr     pushwysp
	ldy     #$10
	jsr     ldeaxysp
	jsr     _get_fat
	ldy     #$02
	jsr     steaxysp
	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	jne     L000B
	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	jsr     toseqeax
	beq     L000E
	ldx     #$00
	lda     #$02
	jmp     L0001
L000E:	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L000F
	ldx     #$00
	lda     #$01
	jmp     L0001
L000F:	jsr     pushw0sp
	ldy     #$10
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _put_fat
	ldy     #$06
	sta     (c_sp),y
	lda     (c_sp),y
	beq     L0011
	ldx     #$00
	lda     (c_sp),y
	jmp     L0001
L0011:	jsr     ldax0sp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	ldy     #$02
	jsr     deceaxy
	jsr     tosulteax
	beq     L0012
	jsr     ldax0sp
	jsr     pushax
	ldy     #$13
	jsr     ldeaxidx
	jsr     saveeax
	ldy     #$01
	jsr     inceaxy
	ldy     #$10
	jsr     steaxspidx
	jsr     resteax
	jsr     ldptr10sp
	ldy     #$05
	lda     (ptr1),y
	ora     #$01
	sta     (ptr1),y
L0012:	ldy     #$05
	jsr     ldeaxysp
	ldy     #$0B
	jsr     steaxysp
	ldy     #$0E
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosulteax
	jne     L0009
L000B:	ldx     #$00
	txa
L0001:	ldy     #$11
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; unsigned long __near__ create_chain (struct $anon-struct-0002 *obj, unsigned long clst)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_create_chain: near

.segment	"CODE"

	jsr     pusheax
	ldy     #$0D
	jsr     subysp
	ldy     #$12
	jsr     ldaxysp
	jsr     pushw
	ldy     #$12
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0002
	jsr     ldax0sp
	ldy     #$0F
	jsr     ldeaxidx
	ldy     #$03
	jsr     steaxysp
	ldy     #$06
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	bne     L0004
	ldy     #$06
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosugeeax
	jeq     L0006
L0004:	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	jmp     L0038
L0002:	ldy     #$16
	jsr     pushwysp
	ldy     #$14
	jsr     ldeaxysp
	jsr     _get_fat
	ldy     #$0B
	jsr     steaxysp
	ldy     #$0E
	jsr     ldeaxysp
	cmp     #$02
	txa
	sbc     #$00
	lda     sreg
	sbc     #$00
	lda     sreg+1
	sbc     #$00
	bcs     L0007
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	jmp     L0001
L0007:	ldy     #$0E
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0008
	ldy     #$0E
	jmp     L002D
L0008:	ldy     #$0E
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosulteax
	beq     L0009
	ldy     #$0E
	jmp     L002D
L0009:	ldy     #$12
	jsr     ldeaxysp
L0038:	ldy     #$03
	jsr     steaxysp
L0006:	jsr     ldax0sp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L000A
	lda     #$00
	tax
	jmp     L0001
L000A:	lda     #$00
	tax
	ldy     #$07
	jsr     steaxysp
	ldy     #$06
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$16
	jsr     ldeaxysp
	jsr     toseqeax
	jeq     L0010
	ldy     #$06
	jsr     ldeaxysp
	ldy     #$01
	jsr     inceaxy
	ldy     #$07
	jsr     steaxysp
	ldy     #$0A
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosugeeax
	beq     L000C
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$02
	ldx     #$00
	ldy     #$07
	jsr     steaxysp
L000C:	ldy     #$16
	jsr     pushwysp
	ldy     #$0C
	jsr     ldeaxysp
	jsr     _get_fat
	ldy     #$0B
	jsr     steaxysp
	ldy     #$0E
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	jsr     toseqeax
	bne     L000E
	ldy     #$0E
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L000D
L000E:	ldy     #$0E
	jmp     L002D
L000D:	ldy     #$0E
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     tosneeax
	beq     L0010
	jsr     ldax0sp
	ldy     #$0F
	jsr     ldeaxidx
	ldy     #$0B
	jsr     steaxysp
	ldy     #$0E
	jsr     ldeaxysp
	cmp     #$02
	txa
	sbc     #$00
	lda     sreg
	sbc     #$00
	lda     sreg+1
	sbc     #$00
	lda     #$00
	bcc     L0030
	ldy     #$0E
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosulteax
	beq     L0036
	ldy     #$0E
	jsr     ldeaxysp
	ldy     #$03
	jsr     steaxysp
L0036:	lda     #$00
L0030:	sta     sreg+1
	sta     sreg
	tax
	ldy     #$07
	jsr     steaxysp
L0010:	ldy     #$0A
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	jeq     L0017
	ldy     #$06
	jsr     ldeaxysp
	ldy     #$07
	jsr     steaxysp
L0019:	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	ldy     #$07
	jsr     laddeqysp
	ldy     #$0A
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosugeeax
	beq     L001B
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$02
	ldx     #$00
	ldy     #$07
	jsr     steaxysp
	ldy     #$0A
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$0A
	jsr     ldeaxysp
	jsr     tosugteax
	beq     L001B
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jmp     L0001
L001B:	ldy     #$16
	jsr     pushwysp
	ldy     #$0C
	jsr     ldeaxysp
	jsr     _get_fat
	ldy     #$0B
	jsr     steaxysp
	ldy     #$0E
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	bne     L0017
	ldy     #$0E
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	jsr     toseqeax
	bne     L001E
	ldy     #$0E
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L001D
L001E:	ldy     #$0E
	jmp     L002D
L001D:	ldy     #$0A
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$0A
	jsr     ldeaxysp
	jsr     toseqeax
	jeq     L0019
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jmp     L0001
L0017:	jsr     pushw0sp
	ldy     #$0C
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     _put_fat
	ldy     #$02
	sta     (c_sp),y
	lda     (c_sp),y
	bne     L0037
	ldy     #$12
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     tosneeax
	beq     L0021
	jsr     pushw0sp
	ldy     #$14
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$10
	jsr     ldeaxysp
	jsr     _put_fat
	ldy     #$02
	sta     (c_sp),y
L0021:	ldy     #$02
L0037:	ldx     #$00
	lda     (c_sp),y
	bne     L0033
	jsr     pushw0sp
	ldy     #$0C
	jsr     ldeaxysp
	ldy     #$0C
	jsr     steaxspidx
	jsr     ldax0sp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     tosneeax
	beq     L002A
	jsr     ldax0sp
	ldy     #$13
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	ldy     #$02
	jsr     deceaxy
	jsr     tosuleeax
	beq     L002A
	jsr     ldax0sp
	jsr     pushax
	ldy     #$13
	jsr     ldeaxidx
	jsr     saveeax
	ldy     #$01
	jsr     deceaxy
	ldy     #$10
	jsr     steaxspidx
	jsr     resteax
	jsr     ldptr10sp
	ldy     #$05
	lda     (ptr1),y
	ora     #$01
	sta     (ptr1),y
	jmp     L002A
L0033:	lda     (c_sp),y
	cmp     #$01
	bne     L0034
	lda     #$FF
	sta     sreg+1
	sta     sreg
	dex
	jmp     L002C
L0034:	lda     #$01
	jsr     axlong
L002C:	ldy     #$07
	jsr     steaxysp
L002A:	ldy     #$0A
L002D:	jsr     ldeaxysp
L0001:	ldy     #$15
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ dir_clear (struct $anon-struct-0001 *fs, unsigned long clst)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_dir_clear: near

.segment	"CODE"

	jsr     pusheax
	ldy     #$0A
	jsr     subysp
	ldy     #$0F
	jsr     ldaxysp
	jsr     _sync_window
	cmp     #$00
	beq     L0002
	ldx     #$00
	lda     #$01
	jmp     L0001
L0002:	ldy     #$11
	jsr     pushwysp
	ldy     #$0F
	jsr     ldeaxysp
	jsr     _clst2sect
	ldy     #$06
	jsr     steaxysp
	ldy     #$11
	jsr     pushwysp
	ldy     #$0B
	jsr     ldeaxysp
	ldy     #$1C
	jsr     steaxspidx
	ldy     #$0F
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldx     #$02
	lda     #$00
	jsr     ___bzero
	ldy     #$0F
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     stax0sp
	ldx     #$00
	lda     #$01
	ldy     #$02
	jsr     staxysp
	txa
	ldy     #$04
	jsr     staxysp
L0003:	ldy     #$07
	jsr     pushwysp
	ldy     #$11
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	jsr     tosicmp
	bcs     L0004
	ldy     #$0F
	jsr     ldptr1ysp
	ldy     #$01
	lda     (ptr1),y
	jsr     pusha
	ldy     #$04
	jsr     pushwysp
	ldy     #$0C
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$0C
	jsr     ldaxysp
	jsr     axulong
	jsr     tosaddeax
	jsr     pusheax
	ldy     #$0A
	jsr     ldaxysp
	jsr     _disk_write
	cmp     #$00
	bne     L0004
	ldy     #$03
	jsr     ldaxysp
	ldy     #$04
	jsr     addeqysp
	jmp     L0003
L0004:	ldy     #$07
	jsr     pushwysp
	ldy     #$11
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	jsr     tosicmp
	bne     L000A
	ldx     #$00
	txa
	jmp     L0001
L000A:	lda     #$01
	ldx     #$00
L0001:	ldy     #$10
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ dir_sdi (struct $anon-struct-0004 *dp, unsigned long ofs)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_dir_sdi: near

.segment	"CODE"

	jsr     pusheax
	jsr     decsp8
	ldy     #$0D
	jsr     ldaxysp
	jsr     pushw
	ldy     #$0D
	jsr     ldeaxysp
	cmp     #$00
	txa
	sbc     #$00
	lda     sreg
	sbc     #$20
	lda     sreg+1
	sbc     #$00
	bcs     L0016
	ldy     #$0D
	jsr     ldeaxysp
	ldx     #$00
	stx     sreg+1
	stx     sreg
	and     #$1F
	jsr     utsteax
	beq     L0002
L0016:	ldx     #$00
	lda     #$02
	jmp     L0001
L0002:	ldy     #$11
	jsr     pushwysp
	ldy     #$0F
	jsr     ldeaxysp
	ldy     #$0E
	jsr     steaxspidx
	ldy     #$0F
	jsr     ldaxysp
	ldy     #$09
	jsr     ldeaxidx
	ldy     #$02
	jsr     steaxysp
	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0009
	jsr     ldptr10sp
	ldy     #$00
	lda     (ptr1),y
	cmp     #$03
	bcc     L0009
	jsr     ldax0sp
	ldy     #$2B
	jsr     ldeaxidx
	ldy     #$02
	jsr     steaxysp
L0009:	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L000A
	ldy     #$0D
	jsr     ldeaxysp
	jsr     shreax4
	jsr     shreax1
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$09
	jsr     ldaxidx
	jsr     axulong
	jsr     tosugeeax
	beq     L000B
	ldx     #$00
	lda     #$02
	jmp     L0001
L000B:	ldy     #$11
	jsr     pushwysp
	ldy     #$03
	jsr     ldaxysp
	ldy     #$2B
	jsr     ldeaxidx
	jmp     L0018
L000A:	jsr     ldax0sp
	ldy     #$0B
	jsr     ldaxidx
	jsr     axulong
	ldy     sreg
	sty     sreg+1
	stx     sreg
	tax
	lda     #$00
	jsr     shleax1
	ldy     #$06
	jsr     steaxysp
	jmp     L000F
L000D:	ldy     #$11
	jsr     pushwysp
	ldy     #$07
	jsr     ldeaxysp
	jsr     _get_fat
	ldy     #$02
	jsr     steaxysp
	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0010
	ldx     #$00
	lda     #$01
	jmp     L0001
L0010:	ldy     #$05
	jsr     ldeaxysp
	cmp     #$02
	txa
	sbc     #$00
	lda     sreg
	sbc     #$00
	lda     sreg+1
	sbc     #$00
	bcc     L0012
	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosugeeax
	beq     L0011
L0012:	ldx     #$00
	lda     #$02
	jmp     L0001
L0011:	ldy     #$09
	jsr     ldeaxysp
	ldy     #$0A
	jsr     lsubeqysp
L000F:	ldy     #$0D
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$0D
	jsr     ldeaxysp
	jsr     tosugeeax
	bne     L000D
	ldy     #$11
	jsr     pushwysp
	ldy     #$05
	jsr     pushwysp
	ldy     #$09
	jsr     ldeaxysp
	jsr     _clst2sect
L0018:	ldy     #$16
	jsr     steaxspidx
	ldy     #$11
	jsr     pushwysp
	ldy     #$07
	jsr     ldeaxysp
	ldy     #$12
	jsr     steaxspidx
	ldy     #$0F
	jsr     ldaxysp
	ldy     #$19
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0014
	ldx     #$00
	lda     #$02
	jmp     L0001
L0014:	ldy     #$0F
	jsr     ldaxysp
	jsr     pushax
	ldy     #$19
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$13
	jsr     ldeaxysp
	txa
	ldx     sreg
	ldy     sreg+1
	sty     sreg
	ldy     #$00
	sty     sreg+1
	jsr     shreax1
	jsr     tosaddeax
	ldy     #$16
	jsr     steaxspidx
	ldy     #$11
	jsr     pushwysp
	ldy     #$03
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$11
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     tosaddax
	ldy     #$1A
	jsr     staxspidx
	ldx     #$00
	txa
L0001:	ldy     #$10
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ dir_next (struct $anon-struct-0004 *dp, int stretch)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_dir_next: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp8
	ldy     #$0B
	jsr     ldaxysp
	jsr     pushw
	ldy     #$0D
	jsr     ldaxysp
	ldy     #$11
	jsr     ldeaxidx
	ldy     #$20
	jsr     inceaxy
	ldy     #$06
	jsr     steaxysp
	ldy     #$09
	jsr     ldeaxysp
	cmp     #$00
	txa
	sbc     #$00
	lda     sreg
	sbc     #$20
	lda     sreg+1
	sbc     #$00
	bcc     L0002
	ldy     #$0F
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	ldy     #$16
	jsr     steaxspidx
L0002:	ldy     #$0D
	jsr     ldaxysp
	ldy     #$19
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0003
	ldx     #$00
	lda     #$04
	jmp     L0001
L0003:	ldy     #$09
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	jeq     L0008
	ldy     #$0D
	jsr     ldaxysp
	jsr     pushax
	ldy     #$19
	jsr     ldeaxidx
	jsr     saveeax
	ldy     #$01
	jsr     inceaxy
	ldy     #$16
	jsr     steaxspidx
	jsr     resteax
	ldy     #$0D
	jsr     ldaxysp
	ldy     #$15
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0005
	ldy     #$09
	jsr     ldeaxysp
	jsr     shreax4
	jsr     shreax1
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$09
	jsr     ldaxidx
	jsr     axulong
	jsr     tosugeeax
	jeq     L0008
	ldy     #$0F
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	ldy     #$16
	jsr     steaxspidx
	lda     #$04
	jmp     L0001
L0005:	ldy     #$09
	jsr     ldeaxysp
	txa
	ldx     sreg
	ldy     sreg+1
	sty     sreg
	ldy     #$00
	sty     sreg+1
	jsr     shreax1
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	jsr     decax1
	jsr     axulong
	jsr     tosandeax
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	jeq     L0008
	ldy     #$0F
	jsr     pushwysp
	ldy     #$0F
	jsr     ldaxysp
	ldy     #$15
	jsr     ldeaxidx
	jsr     _get_fat
	ldy     #$02
	jsr     steaxysp
	ldy     #$05
	jsr     ldeaxysp
	cmp     #$02
	txa
	sbc     #$00
	lda     sreg
	sbc     #$00
	lda     sreg+1
	sbc     #$00
	bcs     L0009
	ldx     #$00
	lda     #$02
	jmp     L0001
L0009:	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L000A
	ldx     #$00
	lda     #$01
	jmp     L0001
L000A:	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     tosugeeax
	jeq     L0011
	ldy     #$0B
	lda     (c_sp),y
	dey
	ora     (c_sp),y
	bne     L000C
	ldy     #$0F
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	ldy     #$16
	jsr     steaxspidx
	lda     #$04
	jmp     L0001
L000C:	ldy     #$0F
	jsr     pushwysp
	ldy     #$0F
	jsr     ldaxysp
	ldy     #$15
	jsr     ldeaxidx
	jsr     _create_chain
	ldy     #$02
	jsr     steaxysp
	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L000D
	ldx     #$00
	lda     #$07
	jmp     L0001
L000D:	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	lda     #$01
	ldx     #$00
	jsr     toseqeax
	beq     L000E
	ldx     #$00
	lda     #$02
	jmp     L0001
L000E:	ldy     #$05
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L000F
	ldx     #$00
	lda     #$01
	jmp     L0001
L000F:	jsr     pushw0sp
	ldy     #$07
	jsr     ldeaxysp
	jsr     _dir_clear
	cmp     #$00
	beq     L0011
	ldx     #$00
	lda     #$01
	jmp     L0001
L0011:	ldy     #$0F
	jsr     pushwysp
	ldy     #$07
	jsr     ldeaxysp
	ldy     #$12
	jsr     steaxspidx
	ldy     #$0F
	jsr     pushwysp
	ldy     #$05
	jsr     pushwysp
	ldy     #$09
	jsr     ldeaxysp
	jsr     _clst2sect
	ldy     #$16
	jsr     steaxspidx
L0008:	ldy     #$0F
	jsr     pushwysp
	ldy     #$0B
	jsr     ldeaxysp
	ldy     #$0E
	jsr     steaxspidx
	ldy     #$0F
	jsr     pushwysp
	ldy     #$03
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$0D
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     tosaddax
	ldy     #$1A
	jsr     staxspidx
	ldx     #$00
	txa
L0001:	ldy     #$0E
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ dir_alloc (struct $anon-struct-0004 *dp, unsigned int n_ent)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_dir_alloc: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp3
	ldy     #$06
	jsr     ldaxysp
	jsr     pushw
	ldy     #$0A
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _dir_sdi
	ldy     #$04
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L0012
	ldy     #$02
	jsr     staxysp
L0003:	jsr     pushw0sp
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$19
	jsr     ldeaxidx
	jsr     _move_window
	ldy     #$04
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0012
	ldy     #$08
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	cmp     #$E5
	beq     L000E
	ldy     #$08
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	beq     L000E
	ldx     #$00
	txa
	jmp     L0010
L000E:	ldy     #$02
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	ldy     #$05
	cmp     (c_sp),y
	bne     L000B
	txa
	iny
	cmp     (c_sp),y
	bne     L000B
	jmp     L0004
L0010:	ldy     #$02
	jsr     staxysp
L000B:	ldy     #$0A
	jsr     pushwysp
	ldx     #$00
	lda     #$01
	jsr     _dir_next
	ldy     #$04
	sta     (c_sp),y
	lda     (c_sp),y
	beq     L0003
L0004:	ldy     #$04
	ldx     #$00
L0012:	lda     (c_sp),y
	cmp     #$04
	bne     L0014
	lda     #$07
	sta     (c_sp),y
L0014:	lda     (c_sp),y
	ldy     #$09
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; unsigned long __near__ ld_clust (struct $anon-struct-0001 *fs, const unsigned char *dir)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_ld_clust: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp4
	ldy     #$05
	jsr     ldaxysp
	ldy     #$1A
	jsr     incaxy
	jsr     _ld_16
	jsr     axulong
	jsr     steax0sp
	ldy     #$07
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	cmp     #$03
	bne     L0002
	jsr     ldeax0sp
	jsr     pusheax
	ldy     #$09
	jsr     ldaxysp
	ldy     #$14
	jsr     incaxy
	jsr     _ld_16
	jsr     axulong
	stx     sreg+1
	sta     sreg
	lda     #$00
	tax
	jsr     tosoreax
	jsr     steax0sp
L0002:	jsr     ldeax0sp
	jmp     incsp8

.endproc

; ---------------------------------------------------------------
; void __near__ st_clust (struct $anon-struct-0001 *fs, unsigned char *dir, unsigned long cl)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_st_clust: near

.segment	"CODE"

	jsr     pusheax
	ldy     #$05
	jsr     ldaxysp
	ldy     #$1A
	jsr     incaxy
	jsr     pushax
	ldy     #$03
	jsr     ldaxysp
	jsr     _st_16
	ldy     #$07
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	cmp     #$03
	bne     L0002
	ldy     #$05
	jsr     ldaxysp
	ldy     #$14
	jsr     incaxy
	jsr     pushax
	ldy     #$05
	jsr     ldeaxysp
	ldx     sreg+1
	lda     sreg
	jsr     _st_16
L0002:	jmp     incsp8

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ dir_read (struct $anon-struct-0004 *dp, int vol)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_dir_read: near

.segment	"CODE"

	jsr     pushax
	lda     #$04
	jsr     pusha
	tay
	jsr     ldaxysp
	jsr     pushw
	jsr     decsp2
	jmp     L000C
L0002:	ldy     #$05
	jsr     pushwysp
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$19
	jsr     ldeaxidx
	jsr     _move_window
	ldy     #$04
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L0012
	ldy     #$08
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	sta     (c_sp),y
	lda     (c_sp),y
	bne     L0006
	tax
	lda     #$04
	tay
	sta     (c_sp),y
	jmp     L0012
L0006:	ldy     #$08
	jsr     ldaxysp
	sta     sreg
	stx     sreg+1
	ldy     #$08
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	and     #$3F
	iny
	sta     (c_sp),y
	ldy     #$04
	sta     (sreg),y
	ldy     #$00
	lda     (c_sp),y
	cmp     #$E5
	beq     L0007
	cmp     #$2E
	beq     L0007
	iny
	lda     (c_sp),y
	cmp     #$0F
	beq     L0007
	and     #$DF
	cmp     #$08
	jsr     booleq
	ldy     #$05
	cmp     (c_sp),y
	bne     L0007
	txa
	iny
	cmp     (c_sp),y
	beq     L0003
L0007:	ldy     #$0A
	jsr     pushwysp
	ldx     #$00
	txa
	jsr     _dir_next
	ldy     #$04
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0012
L000C:	ldy     #$08
	jsr     ldaxysp
	ldy     #$19
	jsr     ldeaxidx
	jsr     utsteax
	jne     L0002
L0003:	ldy     #$04
	ldx     #$00
L0012:	lda     (c_sp),y
	beq     L0014
	ldy     #$0A
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	ldy     #$16
	jsr     steaxspidx
	ldy     #$04
L0014:	lda     (c_sp),y
	ldy     #$09
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ dir_find (struct $anon-struct-0004 *dp)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_dir_find: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp1
	ldy     #$02
	jsr     ldaxysp
	jsr     pushw
	jsr     decsp1
	ldy     #$07
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _dir_sdi
	ldy     #$03
	sta     (c_sp),y
	lda     (c_sp),y
	jne     L000F
L0002:	iny
	jsr     pushwysp
	ldy     #$07
	jsr     ldaxysp
	ldy     #$19
	jsr     ldeaxidx
	jsr     _move_window
	ldy     #$03
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L000C
	ldy     #$05
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	sta     (c_sp),y
	lda     (c_sp),y
	bne     L0007
	tax
	lda     #$04
	ldy     #$03
	sta     (c_sp),y
	jmp     L000C
L0007:	ldy     #$05
	jsr     ldaxysp
	sta     sreg
	stx     sreg+1
	ldy     #$05
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	and     #$3F
	ldy     #$04
	sta     (sreg),y
	iny
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	and     #$08
	bne     L0008
	ldy     #$05
	jsr     ldaxysp
	ldy     #$1B
	jsr     pushwidx
	ldy     #$07
	jsr     ldaxysp
	ldy     #$1C
	jsr     incaxy
	jsr     pushax
	ldx     #$00
	lda     #$0B
	jsr     _memcmp
	stx     tmp1
	ora     tmp1
	beq     L0004
L0008:	ldy     #$07
	jsr     pushwysp
	ldx     #$00
	txa
	jsr     _dir_next
	ldy     #$03
	sta     (c_sp),y
	lda     (c_sp),y
	jeq     L0002
L0004:	ldy     #$03
L000F:	ldx     #$00
L000C:	lda     (c_sp),y
	jmp     incsp6

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ dir_register (struct $anon-struct-0004 *dp)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_dir_register: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp1
	ldy     #$02
	jsr     ldaxysp
	jsr     pushw
	ldy     #$06
	jsr     pushwysp
	ldx     #$00
	lda     #$01
	jsr     _dir_alloc
	ldy     #$02
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0006
	jsr     pushw0sp
	ldy     #$06
	jsr     ldaxysp
	ldy     #$19
	jsr     ldeaxidx
	jsr     _move_window
	ldy     #$02
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0006
	ldy     #$04
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	sta     ptr1
	stx     ptr1+1
	lda     #$00
	ldy     #$1F
L0004:	sta     (ptr1),y
	dey
	bpl     L0004
	ldy     #$04
	jsr     ldaxysp
	ldy     #$1B
	jsr     pushwidx
	ldy     #$06
	jsr     ldaxysp
	ldy     #$1C
	jsr     incaxy
	jsr     pushax
	ldx     #$00
	lda     #$0B
	jsr     _memcpy
	jsr     ldptr10sp
	lda     #$01
	ldy     #$04
	sta     (ptr1),y
	ldy     #$02
	ldx     #$00
L0006:	lda     (c_sp),y
	jmp     incsp5

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ dir_remove (struct $anon-struct-0004 *dp)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_dir_remove: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp1
	ldy     #$02
	jsr     ldaxysp
	jsr     pushw
	jsr     pushw0sp
	ldy     #$06
	jsr     ldaxysp
	ldy     #$19
	jsr     ldeaxidx
	jsr     _move_window
	ldy     #$02
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	bne     L0004
	ldy     #$04
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	sta     ptr1
	stx     ptr1+1
	lda     #$E5
	ldy     #$00
	sta     (ptr1),y
	jsr     ldptr10sp
	lda     #$01
	ldy     #$04
	sta     (ptr1),y
	ldy     #$02
	ldx     #$00
L0004:	lda     (c_sp),y
	jmp     incsp5

.endproc

; ---------------------------------------------------------------
; void __near__ get_fileinfo (struct $anon-struct-0004 *dp, struct $anon-struct-0005 *fno)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_get_fileinfo: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp5
	ldy     #$06
	jsr     ldaxysp
	ldy     #$09
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$00
	tay
	sta     (ptr1),y
	ldy     #$08
	jsr     ldaxysp
	ldy     #$19
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	jne     L0001
	ldx     #$00
	txa
	ldy     #$01
	jsr     staxysp
	ldy     #$03
	jsr     staxysp
	jmp     L0005
L0003:	ldy     #$08
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	sta     ptr1
	stx     ptr1+1
	ldy     #$04
	jsr     ldaxysp
	clc
	adc     ptr1
	sta     ptr1
	txa
	adc     ptr1+1
	sta     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	sta     (c_sp),y
	ldy     #$03
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	ldy     #$00
	lda     (c_sp),y
	cmp     #$20
	beq     L0005
	cmp     #$05
	bne     L0008
	lda     #$E5
	sta     (c_sp),y
L0008:	ldy     #$04
	lda     (c_sp),y
	bne     L0009
	dey
	lda     (c_sp),y
	cmp     #$09
	bne     L0009
	ldy     #$06
	jsr     ldaxysp
	ldy     #$09
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$02
	jsr     ldaxysp
	clc
	adc     ptr1
	sta     ptr1
	txa
	adc     ptr1+1
	sta     ptr1+1
	lda     #$2E
	ldy     #$00
	sta     (ptr1),y
	iny
	ldx     #$00
	tya
	jsr     addeqysp
L0009:	ldy     #$06
	jsr     ldaxysp
	ldy     #$09
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$02
	jsr     ldaxysp
	clc
	adc     ptr1
	sta     ptr1
	txa
	adc     ptr1+1
	sta     ptr1+1
	ldy     #$00
	lda     (c_sp),y
	sta     (ptr1),y
	iny
	ldx     #$00
	tya
	jsr     addeqysp
L0005:	ldy     #$04
	lda     (c_sp),y
	cmp     #$00
	bne     L0006
	dey
	lda     (c_sp),y
	cmp     #$0B
L0006:	jcc     L0003
	ldy     #$06
	jsr     ldaxysp
	ldy     #$09
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$02
	jsr     ldaxysp
	clc
	adc     ptr1
	sta     ptr1
	txa
	adc     ptr1+1
	sta     ptr1+1
	lda     #$00
	tay
	sta     (ptr1),y
	ldy     #$06
	jsr     ldaxysp
	sta     sreg
	stx     sreg+1
	ldy     #$08
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	and     #$3F
	ldy     #$08
	sta     (sreg),y
	jsr     pushwysp
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	ldy     #$1C
	jsr     incaxy
	jsr     _ld_32
	ldy     #$00
	jsr     steaxspidx
	ldy     #$08
	jsr     pushwysp
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	ldy     #$16
	jsr     incaxy
	jsr     _ld_16
	ldy     #$06
	jsr     staxspidx
	ldy     #$08
	jsr     pushwysp
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldaxidx
	ldy     #$16
	jsr     incaxy
	jsr     incax2
	jsr     _ld_16
	ldy     #$04
	jsr     staxspidx
L0001:	ldy     #$09
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ create_name (struct $anon-struct-0004 *dp, const char **path)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_create_name: near

.segment	"CODE"

	jsr     pushax
	ldy     #$0C
	jsr     subysp
	ldy     #$0D
	jsr     ldaxysp
	jsr     ldaxi
	jsr     stax0sp
	ldy     #$0F
	jsr     ldaxysp
	ldy     #$1C
	jsr     incaxy
	ldy     #$08
	jsr     staxysp
	jsr     pushax
	lda     #$20
	jsr     pusha0
	lda     #$0B
	jsr     _memset
	ldx     #$00
	txa
	ldy     #$02
	jsr     staxysp
	ldy     #$04
	jsr     staxysp
	lda     #$08
L003B:	ldy     #$06
	jsr     staxysp
L0005:	ldy     #$05
	jsr     ldaxysp
	clc
	ldy     #$00
	adc     (c_sp),y
	sta     ptr1
	txa
	iny
	adc     (c_sp),y
	sta     ptr1+1
	dey
	lda     (ptr1),y
	ldy     #$0B
	sta     (c_sp),y
	ldy     #$04
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	ldy     #$0B
	lda     (c_sp),y
	cmp     #$21
	jcc     L0003
	cmp     #$2F
	beq     L000C
	cmp     #$5C
	beq     L000C
	jmp     L002C
L000A:	ldy     #$04
	ldx     #$00
	lda     #$01
	jsr     addeqysp
L000C:	ldy     #$05
	jsr     ldaxysp
	clc
	ldy     #$00
	adc     (c_sp),y
	sta     ptr1
	txa
	iny
	adc     (c_sp),y
	sta     ptr1+1
	dey
	lda     (ptr1),y
	cmp     #$2F
	beq     L000A
	ldy     #$05
	jsr     ldaxysp
	clc
	ldy     #$00
	adc     (c_sp),y
	sta     ptr1
	txa
	iny
	adc     (c_sp),y
	sta     ptr1+1
	dey
	lda     (ptr1),y
	cmp     #$5C
	beq     L000A
	jmp     L0003
L002C:	lda     (c_sp),y
	cmp     #$2E
	beq     L002D
	ldy     #$03
	jsr     ldaxysp
	ldy     #$06
	cmp     (c_sp),y
	txa
	iny
	sbc     (c_sp),y
	bcc     L000F
L002D:	ldy     #$07
	lda     (c_sp),y
	bne     L0039
	dey
	lda     (c_sp),y
	cmp     #$0B
	beq     L002E
L0039:	ldy     #$0B
	lda     (c_sp),y
	cmp     #$2E
	bne     L002E
	ldx     #$00
	jmp     L002F
L002E:	ldx     #$00
	lda     #$06
	jmp     L0001
L002F:	lda     #$08
	ldy     #$02
	jsr     staxysp
	lda     #$0B
	jmp     L003B
L000F:	ldy     #$0B
	lda     (c_sp),y
	cmp     #$80
	bcc     L0031
	and     #$7F
	sta     ptr1
	clc
	lda     #>(_ExCvt)
	sta     ptr1+1
	ldy     #<(_ExCvt)
	lda     (ptr1),y
	ldy     #$0B
	sta     (c_sp),y
L0031:	lda     (c_sp),y
	jsr     _dbc_1st
	stx     tmp1
	ora     tmp1
	jeq     L0017
	ldy     #$05
	jsr     ldaxysp
	clc
	ldy     #$00
	adc     (c_sp),y
	sta     ptr1
	txa
	iny
	adc     (c_sp),y
	sta     ptr1+1
	dey
	lda     (ptr1),y
	ldy     #$0A
	sta     (c_sp),y
	ldy     #$04
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	ldy     #$0A
	lda     (c_sp),y
	jsr     _dbc_2nd
	stx     tmp1
	ora     tmp1
	beq     L0019
	ldy     #$05
	jsr     pushwysp
	ldy     #$09
	jsr     ldaxysp
	jsr     decax1
	jsr     tosicmp
	bcc     L0018
L0019:	ldx     #$00
	lda     #$06
	jmp     L0001
L0018:	ldy     #$03
	jsr     ldaxysp
	clc
	ldy     #$08
	adc     (c_sp),y
	sta     ptr1
	txa
	iny
	adc     (c_sp),y
	sta     ptr1+1
	ldy     #$0B
	lda     (c_sp),y
	ldy     #$00
	sta     (ptr1),y
	ldy     #$02
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	ldy     #$03
	jsr     ldaxysp
	clc
	ldy     #$08
	adc     (c_sp),y
	sta     ptr1
	txa
	iny
	adc     (c_sp),y
	sta     ptr1+1
	iny
	lda     (c_sp),y
	ldy     #$00
	sta     (ptr1),y
	ldy     #$02
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	jmp     L0005
L0017:	lda     #<(S0001)
	ldx     #>(S0001)
	jsr     pushax
	ldy     #$0D
	ldx     #$00
	lda     (c_sp),y
	jsr     _strchr
	stx     tmp1
	ora     tmp1
	beq     L001C
	ldx     #$00
	lda     #$06
	jmp     L0001
L001C:	ldy     #$0B
	lda     (c_sp),y
	cmp     #$61
	bcc     L001D
	cmp     #$7B
	bcs     L001D
	sec
	sbc     #$20
	sta     (c_sp),y
L001D:	ldy     #$03
	jsr     ldaxysp
	clc
	ldy     #$08
	adc     (c_sp),y
	sta     ptr1
	txa
	iny
	adc     (c_sp),y
	sta     ptr1+1
	ldy     #$0B
	lda     (c_sp),y
	ldy     #$00
	sta     (ptr1),y
	ldy     #$02
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	jmp     L0005
L0003:	ldy     #$0D
	jsr     ldptr1ysp
	ldy     #$05
	jsr     ldaxysp
	clc
	ldy     #$00
	adc     (c_sp),y
	pha
	txa
	iny
	adc     (c_sp),y
	tax
	pla
	dey
	sta     (ptr1),y
	iny
	txa
	sta     (ptr1),y
	iny
	lda     (c_sp),y
	iny
	ora     (c_sp),y
	bne     L0021
	tax
	lda     #$06
	jmp     L0001
L0021:	ldy     #$09
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	cmp     #$E5
	bne     L0023
	ldy     #$09
	jsr     ldptr1ysp
	lda     #$05
	ldy     #$00
	sta     (ptr1),y
L0023:	ldy     #$09
	jsr     ldaxysp
	ldy     #$0B
	jsr     incaxy
	sta     sreg
	stx     sreg+1
	ldy     #$0B
	lda     (c_sp),y
	cmp     #$21
	bcc     L0035
	ldy     #$05
	jsr     ldaxysp
	clc
	ldy     #$00
	adc     (c_sp),y
	sta     ptr1
	txa
	iny
	adc     (c_sp),y
	sta     ptr1+1
	dey
	lda     (ptr1),y
	cmp     #$21
	bcc     L0035
	tya
	jmp     L0038
L0035:	lda     #$04
	ldy     #$00
L0038:	sta     (sreg),y
	ldx     #$00
	txa
L0001:	ldy     #$10
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ follow_path (struct $anon-struct-0004 *dp, const char *path)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_follow_path: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp2
	ldy     #$05
	jsr     ldaxysp
	jsr     pushw
	jmp     L0004
L0002:	ldy     #$04
	ldx     #$00
	lda     #$01
	jsr     addeqysp
L0004:	ldy     #$05
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	cmp     #$2F
	beq     L0002
	ldy     #$05
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	cmp     #$5C
	beq     L0002
	ldy     #$09
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	ldy     #$06
	jsr     steaxspidx
	ldy     #$05
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	cmp     #$20
	bcs     L000D
	ldy     #$07
	jsr     ldaxysp
	ldy     #$1C
	jsr     incaxy
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$80
	ldy     #$00
	sta     (ptr1),y
	ldy     #$09
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _dir_sdi
	ldy     #$03
	sta     (c_sp),y
	jmp     L0019
L000D:	ldy     #$09
	jsr     pushwysp
	lda     #$06
	jsr     leaa0sp
	jsr     _create_name
	ldy     #$03
	sta     (c_sp),y
	ldx     #$00
	lda     (c_sp),y
	jne     L001A
	ldy     #$07
	jsr     ldaxysp
	ldy     #$1C
	jsr     incaxy
	ldy     #$0B
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	ldy     #$02
	sta     (c_sp),y
	ldy     #$07
	jsr     ldaxysp
	jsr     _dir_find
	ldy     #$03
	sta     (c_sp),y
	lda     (c_sp),y
	beq     L000F
	ldx     #$00
	lda     (c_sp),y
	cmp     #$04
	bne     L001A
	dey
	lda     (c_sp),y
	and     #$04
	bne     L000B
	lda     #$05
	iny
	sta     (c_sp),y
	jmp     L001A
L000F:	dey
	lda     (c_sp),y
	and     #$04
	bne     L000B
	ldy     #$07
	jsr     ldptr1ysp
	ldy     #$04
	lda     (ptr1),y
	and     #$10
	bne     L0016
	tax
	lda     #$05
	dey
	sta     (c_sp),y
	jmp     L001A
L0016:	ldy     #$09
	jsr     pushwysp
	ldy     #$05
	jsr     pushwysp
	ldy     #$05
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     pushax
	ldy     #$0D
	jsr     ldaxysp
	ldy     #$11
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosand0ax
	jsr     tosaddax
	jsr     _ld_clust
	ldy     #$06
	jsr     steaxspidx
	jmp     L000D
L000B:	iny
L0019:	ldx     #$00
L001A:	lda     (c_sp),y
	jmp     incsp8

.endproc

; ---------------------------------------------------------------
; int __near__ get_ldnumber (const char **path)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_get_ldnumber: near

.segment	"CODE"

	jsr     pushax
	jsr     decsp7
	ldy     #$08
	jsr     ldaxysp
	jsr     ldaxi
	ldy     #$05
	jsr     staxysp
	ldy     #$03
	jsr     staxysp
	ldy     #$06
	lda     (c_sp),y
	dey
	ora     (c_sp),y
	bne     L0002
	ldx     #$FF
	jmp     L001F
L0002:	ldy     #$04
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	ldy     #$02
	sta     (c_sp),y
	iny
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	ldy     #$02
	ldx     #$00
	lda     (c_sp),y
	cmp     #$21
	bcc     L0019
	cmp     #$3A
	bne     L0002
L0019:	lda     (c_sp),y
	cmp     #$3A
	bne     L001F
	lda     #$01
	jsr     stax0sp
	ldy     #$06
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	cmp     #$30
	bcc     L000B
	ldy     #$06
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	cmp     #$3A
	bcs     L000B
	ldy     #$06
	jsr     ldaxysp
	jsr     incax2
	ldy     #$03
	cmp     (c_sp),y
	bne     L000B
	txa
	iny
	cmp     (c_sp),y
	bne     L000B
	ldy     #$06
	jsr     ldptr1ysp
	ldx     #$00
	lda     (ptr1,x)
	ldy     #$30
	jsr     decaxy
	jsr     stax0sp
L000B:	jsr     ldax0sp
	cmp     #$01
	txa
	sbc     #$00
	bvs     L0013
	eor     #$80
L0013:	bpl     L0012
	ldx     #$FF
	jmp     L001F
L0012:	ldy     #$08
	jsr     ldptr1ysp
	ldy     #$04
	jsr     ldaxysp
	ldy     #$00
	sta     (ptr1),y
	iny
	txa
	sta     (ptr1),y
	jsr     ldax0sp
	jmp     L0001
L001F:	txa
L0001:	ldy     #$09
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; unsigned int __near__ check_fs (struct $anon-struct-0001 *fs, unsigned long sect)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_check_fs: near

.segment	"CODE"

	jsr     pusheax
	jsr     decsp5
	ldy     #$0A
	jsr     ldptr1ysp
	lda     #$00
	ldy     #$04
	sta     (ptr1),y
	ldy     #$0C
	jsr     pushwysp
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	ldy     #$1C
	jsr     steaxspidx
	ldy     #$0C
	jsr     pushwysp
	ldy     #$0A
	jsr     ldeaxysp
	jsr     _move_window
	cmp     #$00
	beq     L0002
	ldx     #$00
	lda     #$04
	jmp     L0001
L0002:	ldy     #$0A
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$FE
	clc
	adc     ptr1
	pha
	lda     #$01
	adc     ptr1+1
	tax
	pla
	jsr     _ld_16
	ldy     #$01
	jsr     staxysp
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	sta     (c_sp),y
	cmp     #$EB
	beq     L001B
	lda     (c_sp),y
	cmp     #$E9
	beq     L001B
	cmp     #$E8
	beq     L001B
	ldx     #$00
	jmp     L000B
L001B:	ldy     #$02
	lda     (c_sp),y
	cmp     #$AA
	bne     L0006
	dey
	lda     (c_sp),y
	cmp     #$55
	bne     L0006
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$52
	jsr     incaxy
	jsr     pushax
	lda     #<(S0002)
	ldx     #>(S0002)
	jsr     pushax
	ldx     #$00
	lda     #$08
	jsr     _memcmp
	stx     tmp1
	ora     tmp1
	bne     L0006
	tax
	jmp     L0001
L0006:	ldy     #$0A
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$0B
	jsr     incaxy
	jsr     _ld_16
	ldy     #$03
	jsr     staxysp
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$0D
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	sta     (c_sp),y
	ldy     #$04
	jsr     ldaxysp
	jsr     decax1
	ldy     #$03
	and     (c_sp),y
	pha
	txa
	iny
	and     (c_sp),y
	tax
	pla
	cpx     #$00
	jne     L000D
	cmp     #$00
	jne     L000B
	jsr     ldaxysp
	cmp     #$00
	txa
	sbc     #$02
	ldx     #$00
	jcc     L000B
	ldy     #$04
	lda     (c_sp),y
	cmp     #$02
	bne     L000E
	dey
	lda     (c_sp),y
	cmp     #$01
L000E:	jcs     L000B
	ldy     #$00
	lda     (c_sp),y
	jeq     L000B
	sec
	sbc     #$01
	and     (c_sp),y
	pha
	pla
	jne     L000B
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$0E
	jsr     incaxy
	jsr     _ld_16
	cpx     #$00
	bne     L0021
	cmp     #$00
	jeq     L000B
L0021:	ldy     #$0A
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$10
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldx     #$00
	lda     (ptr1,x)
	jsr     decax1
	cpx     #$00
	bne     L0011
	cmp     #$02
L0011:	bcs     L000D
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$11
	jsr     incaxy
	jsr     _ld_16
	cpx     #$00
	bne     L0022
	cmp     #$00
	beq     L000B
L0022:	ldy     #$0A
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$13
	jsr     incaxy
	jsr     _ld_16
	cmp     #$80
	txa
	sbc     #$00
	bcs     L001D
	ldy     #$0A
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$20
	jsr     incaxy
	jsr     _ld_32
	cmp     #$00
	txa
	sbc     #$00
	lda     sreg
	sbc     #$01
	lda     sreg+1
	sbc     #$00
	bcs     L001D
	ldx     #$00
	jmp     L000B
L001D:	ldy     #$0A
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$16
	jsr     incaxy
	jsr     _ld_16
	cpx     #$00
	bne     L0016
	cmp     #$00
	bne     L0024
L000D:	ldx     #$00
	jmp     L000B
L0016:	ldx     #$00
L0024:	txa
	jmp     L0001
L000B:	ldy     #$02
	lda     (c_sp),y
	cmp     #$AA
	bne     L0020
	dey
	lda     (c_sp),y
	cmp     #$55
	bne     L0020
	lda     #$02
	jmp     L0001
L0020:	lda     #$03
L0001:	ldy     #$0B
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; unsigned int __near__ find_volume (struct $anon-struct-0001 *fs, unsigned int part)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_find_volume: near

.segment	"CODE"

	jsr     pushax
	ldy     #$14
	jsr     subysp
	ldy     #$19
	jsr     pushwysp
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     _check_fs
	ldy     #$12
	jsr     staxysp
	cpx     #$00
	bne     L0027
	cmp     #$02
	beq     L0028
L0027:	ldy     #$13
	jsr     ldaxysp
	cmp     #$03
	txa
	sbc     #$00
	jcs     L001C
	ldy     #$14
	lda     (c_sp),y
	iny
	ora     (c_sp),y
	jeq     L001C
	ldx     #$00
L0028:	txa
	ldy     #$10
	jsr     staxysp
L000B:	ldy     #$11
	lda     (c_sp),y
	cmp     #$00
	bne     L000F
	dey
	lda     (c_sp),y
	cmp     #$04
L000F:	bcs     L000C
	ldy     #$11
	jsr     ldaxysp
	jsr     aslax2
	jsr     leaaxsp
	jsr     pushax
	ldy     #$19
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$BE
	clc
	adc     ptr1
	sta     ptr1
	lda     #$01
	adc     ptr1+1
	sta     ptr1+1
	ldy     #$13
	jsr     ldaxysp
	jsr     shlax4
	clc
	adc     ptr1
	pha
	txa
	adc     ptr1+1
	tax
	pla
	jsr     incax8
	jsr     _ld_32
	ldy     #$00
	jsr     steaxspidx
	ldy     #$10
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	jmp     L000B
L000C:	ldy     #$15
	lda     (c_sp),y
	dey
	ora     (c_sp),y
	beq     L0010
	iny
	jsr     ldaxysp
	jsr     decax1
	jmp     L0011
L0010:	tax
L0011:	ldy     #$10
	jsr     staxysp
L0012:	ldy     #$11
	jsr     ldaxysp
	jsr     aslax2
	jsr     leaaxsp
	jsr     ldeaxi
	jsr     utsteax
	beq     L0015
	ldy     #$19
	jsr     pushwysp
	ldy     #$13
	jsr     ldaxysp
	jsr     aslax2
	jsr     incax2
	jsr     leaaxsp
	jsr     ldeaxi
	jsr     _check_fs
	jmp     L0016
L0015:	ldx     #$00
	lda     #$03
L0016:	ldy     #$12
	jsr     staxysp
	ldy     #$14
	lda     (c_sp),y
	iny
	ora     (c_sp),y
	bne     L001C
	ldy     #$13
	jsr     ldaxysp
	cmp     #$02
	txa
	sbc     #$00
	bcc     L001C
	ldy     #$10
	ldx     #$00
	lda     #$01
	jsr     addeqysp
	cpx     #$00
	bne     L0019
	cmp     #$04
L0019:	bcc     L0012
L001C:	ldy     #$13
	jsr     ldaxysp
	ldy     #$18
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ mount_volume (const char **path, struct $anon-struct-0001 **rfs, unsigned char mode)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_mount_volume: near

.segment	"CODE"

	jsr     pusha
	ldy     #$0B
	jsr     subysp
	ldy     #$0D
	jsr     ldptr1ysp
	lda     #$00
	tay
	sta     (ptr1),y
	iny
	sta     (ptr1),y
	ldy     #$0F
	jsr     ldaxysp
	jsr     _get_ldnumber
	ldy     #$09
	jsr     staxysp
	cpx     #$80
	bcc     L0002
	ldx     #$00
	lda     #$0B
	jmp     L0001
L0002:	ldy     #$0A
	jsr     ldaxysp
	jsr     aslax1
	clc
	adc     #<(_FatFs)
	tay
	txa
	adc     #>(_FatFs)
	tax
	tya
	jsr     ldaxi
	ldy     #$07
	jsr     staxysp
	stx     tmp1
	ora     tmp1
	bne     L0003
	tax
	lda     #$0C
	jmp     L0001
L0003:	ldy     #$0D
	jsr     ldptr1ysp
	ldy     #$08
	jsr     ldaxysp
	ldy     #$00
	sta     (ptr1),y
	iny
	txa
	sta     (ptr1),y
	ldy     #$0B
	lda     (c_sp),y
	and     #$FE
	sta     (c_sp),y
	ldy     #$08
	jsr     ldptr1ysp
	ldy     #$00
	lda     (ptr1),y
	beq     L0005
	ldy     #$08
	jsr     ldptr1ysp
	ldy     #$01
	lda     (ptr1),y
	jsr     _disk_status
	ldy     #$06
	sta     (c_sp),y
	ldx     #$00
	and     #$01
	bne     L0005
	ldy     #$0B
	lda     (c_sp),y
	jeq     L0001
	ldy     #$06
	lda     (c_sp),y
	and     #$04
	jeq     L0001
	lda     #$0A
	jmp     L0001
L0005:	ldy     #$08
	jsr     ldptr1ysp
	lda     #$00
	tay
	sta     (ptr1),y
	ldy     #$08
	jsr     ldptr1ysp
	ldy     #$01
	lda     (ptr1),y
	jsr     _disk_initialize
	ldy     #$06
	sta     (c_sp),y
	and     #$01
	beq     L000A
	ldx     #$00
	lda     #$03
	jmp     L0001
L000A:	ldy     #$0B
	lda     (c_sp),y
	beq     L000B
	ldy     #$06
	lda     (c_sp),y
	and     #$04
	beq     L000B
	ldx     #$00
	lda     #$0A
	jmp     L0001
L000B:	ldy     #$0A
	jsr     pushwysp
	ldx     #$00
	txa
	jsr     _find_volume
	jsr     stax0sp
	cpx     #$00
	bne     L000F
	cmp     #$04
	bne     L000F
	lda     #$01
	jmp     L0001
L000F:	jsr     ldax0sp
	cmp     #$02
	txa
	sbc     #$00
	bcc     L0011
	ldx     #$00
	lda     #$0D
	jmp     L0001
L0011:	ldy     #$08
	jsr     ldaxysp
	ldy     #$1F
	jsr     ldeaxidx
	ldy     #$02
	jsr     steaxysp
	ldy     #$16
	jsr     subysp
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$0B
	jsr     incaxy
	jsr     _ld_16
	cpx     #$02
	bne     L004C
	cmp     #$00
	beq     L0012
L004C:	ldx     #$00
	lda     #$0D
	ldy     #$16
	jsr     addysp
	jmp     L0001
L0012:	ldy     #$1E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$16
	jsr     incaxy
	jsr     _ld_16
	jsr     axulong
	ldy     #$0A
	jsr     steaxysp
	ldy     #$0D
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0014
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$24
	jsr     incaxy
	jsr     _ld_32
	ldy     #$0A
	jsr     steaxysp
L0014:	ldy     #$20
	jsr     pushwysp
	ldy     #$0F
	jsr     ldeaxysp
	ldy     #$18
	jsr     steaxspidx
	ldy     #$1E
	jsr     ldaxysp
	sta     sreg
	stx     sreg+1
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$10
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	ldy     #$03
	sta     (sreg),y
	ldy     #$1E
	jsr     ldptr1ysp
	ldy     #$03
	lda     (ptr1),y
	cmp     #$01
	beq     L0015
	ldy     #$1E
	jsr     ldptr1ysp
	ldy     #$03
	lda     (ptr1),y
	cmp     #$02
	beq     L0015
	ldx     #$00
	lda     #$0D
	ldy     #$16
	jsr     addysp
	jmp     L0001
L0015:	ldy     #$0D
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$22
	jsr     ldptr1ysp
	ldy     #$03
	ldx     #$00
	lda     (ptr1),y
	jsr     axulong
	jsr     tosumuleax
	ldy     #$0A
	jsr     steaxysp
	ldy     #$1E
	jsr     ldaxysp
	sta     sreg
	stx     sreg+1
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$0D
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	ldy     #$0A
	sta     (sreg),y
	iny
	lda     #$00
	sta     (sreg),y
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	cpx     #$00
	bne     L004D
	cmp     #$00
	beq     L0050
L004D:	ldy     #$1E
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	sta     sreg
	stx     sreg+1
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	jsr     decax1
	and     sreg
	pha
	txa
	and     sreg+1
	sta     tmp1
	pla
	ora     tmp1
	beq     L0019
	ldx     #$00
L0050:	lda     #$0D
	ldy     #$16
	jsr     addysp
	jmp     L0001
L0019:	ldy     #$20
	jsr     pushwysp
	ldy     #$20
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$11
	jsr     incaxy
	jsr     _ld_16
	ldy     #$08
	jsr     staxspidx
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$09
	jsr     ldaxidx
	and     #$0F
	beq     L001D
	ldx     #$00
	lda     #$0D
	ldy     #$16
	jsr     addysp
	jmp     L0001
L001D:	ldy     #$1E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$13
	jsr     incaxy
	jsr     _ld_16
	jsr     axulong
	ldy     #$12
	jsr     steaxysp
	ldy     #$15
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L001E
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$20
	jsr     incaxy
	jsr     _ld_32
	ldy     #$12
	jsr     steaxysp
L001E:	ldy     #$1E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$0E
	jsr     incaxy
	jsr     _ld_16
	jsr     stax0sp
	cpx     #$00
	bne     L001F
	cmp     #$00
	bne     L001F
	lda     #$0D
	ldy     #$16
	jsr     addysp
	jmp     L0001
L001F:	jsr     pushw0sp
	ldy     #$0F
	jsr     ldeaxysp
	jsr     tosulong
	jsr     tosaddeax
	jsr     pusheax
	ldy     #$22
	jsr     ldaxysp
	ldy     #$09
	jsr     ldaxidx
	jsr     shrax4
	jsr     axulong
	jsr     tosaddeax
	ldy     #$0E
	jsr     steaxysp
	ldy     #$15
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$15
	jsr     ldeaxysp
	jsr     tosulteax
	beq     L0021
	ldx     #$00
	lda     #$0D
	ldy     #$16
	jsr     addysp
	jmp     L0001
L0021:	ldy     #$15
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$15
	jsr     ldeaxysp
	jsr     tossubeax
	jsr     pusheax
	ldy     #$22
	jsr     ldaxysp
	ldy     #$0B
	jsr     ldaxidx
	jsr     axulong
	jsr     tosudiveax
	ldy     #$06
	jsr     steaxysp
	ldy     #$09
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$00
	sta     sreg+1
	sta     sreg
	tax
	jsr     toseqeax
	beq     L0022
	ldx     #$00
	lda     #$0D
	ldy     #$16
	jsr     addysp
	jmp     L0001
L0022:	ldx     #$00
	txa
	ldy     #$16
	jsr     staxysp
	ldy     #$09
	jsr     ldeaxysp
	cmp     #$F6
	txa
	sbc     #$FF
	lda     sreg
	sbc     #$FF
	lda     sreg+1
	sbc     #$0F
	bcs     L0023
	ldx     #$00
	lda     #$03
	ldy     #$16
	jsr     staxysp
L0023:	ldy     #$09
	jsr     ldeaxysp
	cmp     #$F6
	txa
	sbc     #$FF
	lda     sreg
	sbc     #$00
	lda     sreg+1
	sbc     #$00
	bcs     L0024
	ldx     #$00
	lda     #$02
	ldy     #$16
	jsr     staxysp
L0024:	ldy     #$09
	jsr     ldeaxysp
	cmp     #$F6
	txa
	sbc     #$0F
	lda     sreg
	sbc     #$00
	lda     sreg+1
	sbc     #$00
	bcs     L0025
	ldx     #$00
	lda     #$01
	ldy     #$16
	jsr     staxysp
L0025:	ldy     #$16
	lda     (c_sp),y
	iny
	ora     (c_sp),y
	bne     L0026
	tax
	lda     #$0D
	dey
	jsr     addysp
	jmp     L0001
L0026:	ldy     #$20
	jsr     pushwysp
	ldy     #$0B
	jsr     ldeaxysp
	ldy     #$02
	jsr     inceaxy
	ldy     #$14
	jsr     steaxspidx
	ldy     #$20
	jsr     pushwysp
	ldy     #$1D
	jsr     ldeaxysp
	ldy     #$20
	jsr     steaxspidx
	ldy     #$20
	jsr     pushwysp
	ldy     #$1D
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$07
	jsr     ldaxysp
	jsr     axulong
	jsr     tosaddeax
	ldy     #$24
	jsr     steaxspidx
	ldy     #$20
	jsr     pushwysp
	ldy     #$1D
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$17
	jsr     ldeaxysp
	jsr     tosaddeax
	ldy     #$2C
	jsr     steaxspidx
	ldy     #$17
	lda     (c_sp),y
	bne     L0028
	dey
	lda     (c_sp),y
	cmp     #$03
	bne     L0028
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$2A
	jsr     incaxy
	jsr     _ld_16
	cpx     #$00
	bne     L004E
	cmp     #$00
	beq     L002A
L004E:	ldx     #$00
	lda     #$0D
	ldy     #$16
	jsr     addysp
	jmp     L0001
L002A:	ldy     #$1E
	jsr     ldaxysp
	ldy     #$09
	jsr     ldaxidx
	cpx     #$00
	bne     L004F
	cmp     #$00
	beq     L002C
L004F:	ldx     #$00
	lda     #$0D
	ldy     #$16
	jsr     addysp
	jmp     L0001
L002C:	ldy     #$20
	jsr     pushwysp
	ldy     #$20
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$2C
	jsr     incaxy
	jsr     _ld_32
	ldy     #$28
	jsr     steaxspidx
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     shleax2
	jmp     L0033
L0028:	ldy     #$1E
	jsr     ldaxysp
	ldy     #$09
	jsr     ldaxidx
	cpx     #$00
	bne     L002F
	cmp     #$00
	bne     L002F
	lda     #$0D
	ldy     #$16
	jsr     addysp
	jmp     L0001
L002F:	ldy     #$20
	jsr     pushwysp
	ldy     #$20
	jsr     ldaxysp
	ldy     #$27
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$13
	jsr     ldeaxysp
	jsr     tosaddeax
	ldy     #$28
	jsr     steaxspidx
	ldy     #$17
	lda     (c_sp),y
	bne     L0032
	dey
	lda     (c_sp),y
	cmp     #$02
	bne     L0032
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     shleax1
	jmp     L0033
L0032:	ldy     #$1E
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	jsr     pusheax
	lda     #$03
	ldx     #$00
	jsr     tosumul0ax
	jsr     shreax1
	jsr     pusheax
	ldy     #$22
	jsr     ldaxysp
	ldy     #$17
	jsr     ldeaxidx
	ldx     #$00
	and     #$01
	jsr     tosadd0ax
L0033:	ldy     #$02
	jsr     steaxysp
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$1B
	jsr     ldeaxidx
	jsr     pusheax
	ldy     #$09
	jsr     ldeaxysp
	jsr     pusheax
	lda     #$FF
	ldx     #$01
	jsr     tosadd0ax
	txa
	ldx     sreg
	ldy     sreg+1
	sty     sreg
	ldy     #$00
	sty     sreg+1
	jsr     shreax1
	jsr     tosulteax
	beq     L0034
	ldx     #$00
	lda     #$0D
	ldy     #$16
	jsr     addysp
	jmp     L0001
L0034:	ldy     #$20
	jsr     pushwysp
	ldy     #$22
	jsr     pushwysp
	lda     #$FF
	sta     sreg+1
	sta     sreg
	tax
	ldy     #$10
	jsr     steaxspidx
	ldy     #$0C
	jsr     steaxspidx
	ldy     #$1E
	jsr     ldptr1ysp
	lda     #$80
	ldy     #$05
	sta     (ptr1),y
	ldy     #$17
	lda     (c_sp),y
	jne     L003B
	dey
	lda     (c_sp),y
	cmp     #$03
	jne     L0051
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	ldy     #$30
	jsr     incaxy
	jsr     _ld_16
	cpx     #$00
	jne     L003B
	cmp     #$01
	jne     L003B
	ldy     #$20
	jsr     pushwysp
	ldy     #$1D
	jsr     ldeaxysp
	ldy     #$01
	jsr     inceaxy
	jsr     _move_window
	cmp     #$00
	jne     L003B
	ldy     #$1E
	jsr     ldptr1ysp
	lda     #$00
	ldy     #$05
	sta     (ptr1),y
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	jsr     _ld_32
	jsr     pusheax
	lda     #$41
	sta     sreg+1
	lda     #$61
	sta     sreg
	lda     #$52
	tax
	jsr     toseqeax
	jeq     L003B
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$E4
	clc
	adc     ptr1
	pha
	lda     #$01
	adc     ptr1+1
	tax
	pla
	jsr     _ld_32
	jsr     pusheax
	lda     #$61
	sta     sreg+1
	lda     #$41
	sta     sreg
	lda     #$72
	tax
	jsr     toseqeax
	jeq     L003B
	ldy     #$1E
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$FC
	clc
	adc     ptr1
	pha
	lda     #$01
	adc     ptr1+1
	tax
	pla
	jsr     _ld_32
	jsr     pusheax
	lda     #$AA
	sta     sreg+1
	lda     #$55
	sta     sreg
	lda     #$00
	tax
	jsr     toseqeax
	beq     L003B
	ldy     #$20
	jsr     pushwysp
	ldy     #$20
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$E8
	clc
	adc     ptr1
	pha
	lda     #$01
	adc     ptr1+1
	tax
	pla
	jsr     _ld_32
	ldy     #$10
	jsr     steaxspidx
	ldy     #$20
	jsr     pushwysp
	ldy     #$20
	jsr     ldaxysp
	ldy     #$30
	jsr     incaxy
	sta     ptr1
	stx     ptr1+1
	lda     #$EC
	clc
	adc     ptr1
	pha
	lda     #$01
	adc     ptr1+1
	tax
	pla
	jsr     _ld_32
	ldy     #$0C
	jsr     steaxspidx
L003B:	ldy     #$16
L0051:	jsr     addysp
	ldy     #$08
	jsr     ldptr1ysp
	ldy     #$00
	lda     (c_sp),y
	sta     (ptr1),y
	ldy     #$08
	jsr     ldptr1ysp
	inc     _Fsid
	bne     L003F
	inc     _Fsid+1
L003F:	lda     _Fsid
	ldy     #$06
	sta     (ptr1),y
	iny
	lda     _Fsid+1
	sta     (ptr1),y
	ldx     #$00
	txa
L0001:	ldy     #$10
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; enum $anon-enum-0007 __near__ validate (struct $anon-struct-0002 *obj, struct $anon-struct-0001 **rfs)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_validate: near

.segment	"CODE"

	jsr     pushax
	lda     #$09
	jsr     pusha
	ldy     #$04
	lda     (c_sp),y
	dey
	ora     (c_sp),y
	beq     L0006
	iny
	jsr     ldaxysp
	ldy     #$00
	sta     ptr1
	stx     ptr1+1
	lda     (ptr1),y
	iny
	ora     (ptr1),y
	beq     L0006
	ldy     #$04
	jsr     ldaxysp
	jsr     ldaxi
	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	beq     L0006
	ldy     #$04
	jsr     ldaxysp
	ldy     #$03
	jsr     pushwidx
	ldy     #$06
	jsr     ldaxysp
	jsr     ldaxi
	ldy     #$07
	jsr     ldaxidx
	jsr     tosicmp
	bne     L0006
	ldy     #$04
	jsr     ldaxysp
	jsr     ldaxi
	sta     ptr1
	stx     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	jsr     _disk_status
	and     #$01
	bne     L0006
	tay
	sta     (c_sp),y
L0006:	ldy     #$02
	jsr     ldaxysp
	sta     sreg
	stx     sreg+1
	ldx     #$00
	lda     (c_sp,x)
	bne     L000B
	ldy     #$04
	jsr     ldaxysp
	jsr     ldaxi
	jmp     L0008
L000B:	txa
L0008:	ldy     #$00
	sta     (sreg),y
	iny
	txa
	sta     (sreg),y
	ldx     #$00
	lda     (c_sp,x)
	jmp     incsp5

.endproc

